<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Escola do Or√°culo | Cursos de Tarot Online - Rafaella Kally</title>
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" href="/favicon.svg" />
    <link
      rel="icon"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='100%25' height='100%25' fill='%234b0082'/%3E%3Cg transform='translate(16,12)'%3E%3Ccircle cx='16' cy='16' r='12' fill='%23d4a574'/%3E%3Cpath d='M8 24 C12 12, 20 12, 24 24' stroke='%23fff' stroke-width='2' fill='none' stroke-linecap='round'/%3E%3C/g%3E%3C/svg%3E"
    />
    <meta
      name="description"
      content="Aprenda tarot profissional com Rafaella Kally. Cursos online de tarot em 3 m√≥dulos, comunidade exclusiva e forma√ß√£o de tar√≥logos √©ticos em Portugal e Brasil."
    />
    <meta
      name="keywords"
      content="tarot, cursos online, aprender tarot, tar√≥logo, leitura de tarot, Portugal, Brasil"
    />
    <meta name="author" content="Rafaella Kally" />
    <meta
      property="og:title"
      content="Escola do Or√°culo - Cursos de Tarot Online"
    />
    <meta
      property="og:description"
      content="Domine o tarot sem decorar. Aprenda com Rafaella Kally e forme-se como tar√≥loga profissional."
    />
    <meta
      property="og:image"
      content="https://via.placeholder.com/1200x630?text=Escola+do+Oraculo"
    />
    <meta property="og:url" content="https://tarostesia.com" />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="theme-color" content="#4b0082" />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --color-cream: #f5f5f0;
        --color-dark-purple: #4b0082;
        --color-gold: #c5a059;
        --color-text: #2c2c2c;
        --color-text-light: #6b6b6b;
        --color-white: #ffffff;
        --color-accent: #e8dcc8;
        --font-serif: "Georgia", "Playfair Display", serif;
        --font-sans: "Segoe UI", "Lato", sans-serif;
      }

      /* ===== DARK MODE ===== */
      :root[data-theme="dark"] {
        --color-cream: #1a1a2e;
        --color-dark-purple: #7e2da0;
        --color-gold: #d4a574;
        --color-text: #f5f5f0;
        --color-text-light: #b8b8b8;
        --color-white: #2d2d44;
        --color-accent: #3a3a52;
      }

      html {
        scroll-behavior: smooth;
      }

      body {
        font-family: var(--font-sans);
        background: linear-gradient(to bottom, var(--color-cream), #fafaf8);
        color: var(--color-text);
        line-height: 1.6;
        transition: background-color 0.3s, color 0.3s;
      }

      /* ===== NAVIGATION ===== */
      nav {
        position: fixed;
        top: 0;
        width: 100%;
        background: rgba(245, 245, 240, 0.95);
        backdrop-filter: blur(10px);
        padding: 1rem 2rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        z-index: 1000;
        border-bottom: 1px solid rgba(75, 0, 130, 0.1);
      }

      .nav-toggle {
        display: none;
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: var(--color-dark-purple);
      }

      .nav-toggle:hover {
        color: var(--color-gold);
      }

      .theme-toggle {
        background: none;
        border: none;
        font-size: 1.3rem;
        cursor: pointer;
        transition: transform 0.3s;
      }

      .theme-toggle:hover {
        transform: rotate(20deg);
      }

      @media (max-width: 768px) {
        .nav-toggle {
          display: block;
        }

        nav ul {
          position: absolute;
          top: 60px;
          left: 0;
          width: 100%;
          background: rgba(245, 245, 240, 0.98);
          flex-direction: column;
          gap: 0;
          display: none;
          padding: 1rem 0;
          border-bottom: 1px solid rgba(75, 0, 130, 0.1);
        }

        nav ul.active {
          display: flex;
        }

        nav li {
          padding: 0.75rem 2rem;
          border-bottom: 1px solid rgba(75, 0, 130, 0.05);
        }
      }

      .logo {
        font-size: 1.8rem;
        font-weight: bold;
        color: var(--color-dark-purple);
        font-family: var(--font-serif);
        letter-spacing: 2px;
      }

      .logo-small {
        font-size: 0.7rem;
        color: var(--color-gold);
        display: block;
        margin-top: -0.3rem;
      }

      nav ul {
        display: flex;
        list-style: none;
        gap: 2rem;
      }

      nav a {
        text-decoration: none;
        color: var(--color-text);
        font-size: 0.95rem;
        font-weight: 500;
        transition: color 0.3s;
        border-bottom: 2px solid transparent;
      }

      nav a:hover {
        color: var(--color-dark-purple);
        border-bottom: 2px solid var(--color-gold);
      }

      @media (max-width: 768px) {
        nav ul {
          gap: 1rem;
          font-size: 0.85rem;
        }
      }

      /* ===== HERO SECTION ===== */
      .hero {
        margin-top: 80px;
        padding: 6rem 2rem;
        text-align: center;
        background: linear-gradient(
          135deg,
          var(--color-cream) 0%,
          var(--color-accent) 100%
        );
        min-height: 600px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      .hero h1 {
        font-family: var(--font-serif);
        font-size: 3.5rem;
        color: var(--color-dark-purple);
        margin-bottom: 1rem;
        letter-spacing: -1px;
      }

      .hero .tagline {
        font-size: 1.4rem;
        color: var(--color-text-light);
        margin-bottom: 2rem;
        font-weight: 300;
      }

      .hero .subtext {
        font-size: 1.1rem;
        color: var(--color-text);
        max-width: 600px;
        margin: 0 auto 3rem;
        line-height: 1.8;
      }

      .cta-button {
        background: var(--color-dark-purple);
        color: var(--color-white);
        padding: 1rem 2.5rem;
        border: none;
        border-radius: 50px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        text-decoration: none;
        display: inline-block;
        box-shadow: 0 10px 30px rgba(75, 0, 130, 0.2);
      }

      .cta-button:hover,
      .cta-button:focus {
        background: var(--color-gold);
        transform: translateY(-2px);
        box-shadow: 0 15px 40px rgba(75, 0, 130, 0.3);
        color: var(--color-text);
        outline: 2px solid transparent;
      }

      .cta-button:focus-visible {
        outline: 2px solid var(--color-dark-purple);
        outline-offset: 2px;
      }

      /* ===== CARD SECTION ===== */
      .section {
        padding: 4rem 2rem;
        max-width: 1200px;
        margin: 0 auto;
      }

      .section-title {
        font-family: var(--font-serif);
        font-size: 2.5rem;
        color: var(--color-dark-purple);
        text-align: center;
        margin-bottom: 3rem;
        position: relative;
      }

      .section-title::after {
        content: "";
        display: block;
        width: 60px;
        height: 3px;
        background: var(--color-gold);
        margin: 1rem auto 0;
      }

      .cards-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin-top: 2rem;
      }

      .card {
        background: var(--color-white);
        border-radius: 12px;
        padding: 2rem;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        transition: all 0.3s;
        border: 1px solid rgba(75, 0, 130, 0.1);
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(75, 0, 130, 0.15);
        border-color: var(--color-gold);
      }

      .card-icon {
        font-size: 2.5rem;
        margin-bottom: 1rem;
      }

      .card h3 {
        font-family: var(--font-serif);
        font-size: 1.5rem;
        margin-bottom: 1rem;
        color: var(--color-dark-purple);
      }

      .card p {
        color: var(--color-text-light);
        line-height: 1.7;
        margin-bottom: 1.5rem;
      }

      .card-price {
        font-size: 1.8rem;
        font-weight: bold;
        color: var(--color-gold);
        margin-bottom: 1rem;
      }

      .card-price-old {
        font-size: 1rem;
        color: var(--color-text-light);
        text-decoration: line-through;
        margin-right: 0.5rem;
      }

      /* ===== TESTIMONIALS ===== */
      .testimonial {
        background: var(--color-white);
        padding: 2rem;
        border-radius: 12px;
        border-left: 4px solid var(--color-gold);
        margin-bottom: 2rem;
      }

      .testimonial-text {
        font-style: italic;
        color: var(--color-text-light);
        margin-bottom: 1rem;
        font-size: 1.05rem;
      }

      .testimonial-author {
        font-weight: 600;
        color: var(--color-dark-purple);
      }

      .testimonial-role {
        font-size: 0.9rem;
        color: var(--color-text-light);
      }

      .stars {
        color: var(--color-gold);
        font-size: 1rem;
        margin-bottom: 0.5rem;
      }

      /* ===== ABOUT SECTION ===== */
      .about {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 3rem;
        align-items: center;
      }

      .about-text h2 {
        font-family: var(--font-serif);
        font-size: 2rem;
        margin-bottom: 1.5rem;
        color: var(--color-dark-purple);
      }

      .about-text p {
        color: var(--color-text-light);
        margin-bottom: 1rem;
        line-height: 1.8;
      }

      .about-image {
        background: linear-gradient(
          135deg,
          var(--color-dark-purple),
          var(--color-gold)
        );
        border-radius: 12px;
        height: 400px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--color-white);
        font-size: 4rem;
      }

      @media (max-width: 768px) {
        .about {
          grid-template-columns: 1fr;
        }

        .about-image {
          height: 250px;
        }
      }

      /* ===== INTERACTIVE CARD DRAW ===== */
      .card-draw-container {
        background: linear-gradient(
          135deg,
          rgba(75, 0, 130, 0.05),
          rgba(197, 160, 89, 0.05)
        );
        padding: 3rem;
        border-radius: 12px;
        text-align: center;
        margin: 3rem 0;
      }

      .card-draw-container h3 {
        font-family: var(--font-serif);
        font-size: 1.8rem;
        color: var(--color-dark-purple);
        margin-bottom: 1rem;
      }

      .card-draw-box {
        display: inline-block;
        background: var(--color-white);
        border: 2px solid var(--color-gold);
        padding: 2rem;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s;
        margin: 1rem 0;
      }

      .card-draw-box:hover {
        transform: scale(1.05);
        box-shadow: 0 10px 25px rgba(75, 0, 130, 0.2);
      }

      .card-draw-box.three-card {
        flex: 1;
        min-width: 120px;
        max-width: 180px;
        padding: 1.5rem 1rem;
        margin: 0;
      }

      .card-result {
        margin: 1rem 0;
        animation: flip 0.6s ease-in-out;
      }
      .card-result img,
      .card-image-preview {
        width: 140px;
        height: auto;
        display: block;
        border-radius: 8px;
        box-shadow: 0 12px 28px rgba(0, 0, 0, 0.12);
        margin: 0 auto;
      }
      .three-cards-grid img {
        width: 64px;
        height: auto;
      }
      .card-draw-box p {
        color: var(--color-text);
      }

      @keyframes flip {
        0%,
        100% {
          transform: rotateY(0deg);
        }
        50% {
          transform: rotateY(90deg);
        }
      }

      /* Reading Type Buttons */
      .reading-type-btn {
        background: rgba(197, 160, 89, 0.1);
        border: 2px solid var(--color-gold);
        color: var(--color-text);
        padding: 0.75rem 1.5rem;
        border-radius: 25px;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.3s;
        font-size: 0.95rem;
      }

      .reading-type-btn:hover {
        background: rgba(197, 160, 89, 0.2);
        transform: translateY(-2px);
      }

      .reading-type-btn.active {
        background: var(--color-gold);
        color: var(--color-text);
        font-weight: 600;
      }

      /* Card Display */
      .card-display,
      .card-display-three,
      .card-display-celtic {
        background: var(--color-white);
        border: 1px solid rgba(75, 0, 130, 0.1);
        border-radius: 12px;
        padding: 2rem;
        animation: slideInUp 0.5s ease;
      }

      @keyframes slideInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .card-info {
        text-align: center;
        margin-bottom: 1.5rem;
      }

      .card-emoji {
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .card-name {
        font-family: var(--font-serif);
        font-size: 1.8rem;
        color: var(--color-dark-purple);
        margin-bottom: 0.5rem;
        font-weight: bold;
      }

      .card-suit {
        color: var(--color-gold);
        font-size: 0.95rem;
        font-weight: 600;
        margin-bottom: 1rem;
      }

      .card-element {
        font-size: 0.9rem;
        color: var(--color-text-light);
        margin-bottom: 1.5rem;
      }

      .card-meaning {
        background: rgba(75, 0, 130, 0.05);
        padding: 1.5rem;
        border-radius: 8px;
        border-left: 4px solid var(--color-gold);
        margin-bottom: 1rem;
      }

      .card-meaning-label {
        font-weight: 600;
        color: var(--color-dark-purple);
        font-size: 0.9rem;
        margin-bottom: 0.5rem;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .card-meaning-text {
        color: var(--color-text-light);
        line-height: 1.6;
        font-size: 0.95rem;
      }

      .card-reversed {
        background: rgba(197, 160, 89, 0.05);
        border-left-color: rgba(197, 160, 89, 0.5);
      }

      /* Three Card Display */
      .three-cards-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        margin-top: 2rem;
      }

      .three-card-item {
        background: rgba(75, 0, 130, 0.05);
        padding: 1.5rem;
        border-radius: 8px;
        border-top: 3px solid var(--color-gold);
      }

      .three-card-position {
        font-weight: 600;
        color: var(--color-dark-purple);
        margin-bottom: 1rem;
        font-size: 1.1rem;
      }

      /* Chakra Cards Grid */
      .chakra-cards-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 1.5rem;
        margin-top: 2rem;
      }
      .chakra-card-item {
        background: linear-gradient(
          135deg,
          var(--color-accent) 0%,
          rgba(212, 165, 116, 0.1) 100%
        );
        border: 2px solid var(--color-gold);
        border-radius: 8px;
        padding: 1rem;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }
      .chakra-card-item:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 16px rgba(75, 0, 130, 0.15);
        border-color: var(--color-dark-purple);
      }
      .chakra-name {
        font-weight: bold;
        color: var(--color-dark-purple);
        margin-bottom: 0.5rem;
        font-size: 0.9rem;
      }
      .chakra-emoji {
        font-size: 2rem;
        margin: 0.5rem 0;
      }
      .chakra-card-name {
        font-size: 0.85rem;
        color: var(--color-text);
        margin: 0.5rem 0;
        font-weight: 600;
      }
      .chakra-card-meaning {
        font-size: 0.75rem;
        color: var(--color-text-light);
        margin-top: 0.5rem;
        font-style: italic;
      }
      /* Celtic Cross Display */
      .celtic-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 1.5rem;
        margin-top: 2rem;
      }

      .celtic-position {
        background: rgba(75, 0, 130, 0.05);
        padding: 1.5rem;
        border-radius: 8px;
        border: 2px solid var(--color-gold);
        text-align: center;
      }

      .celtic-position-number {
        font-weight: 700;
        color: var(--color-gold);
        font-size: 0.8rem;
        margin-bottom: 0.5rem;
      }

      .celtic-position-name {
        font-weight: 600;
        color: var(--color-dark-purple);
        margin-bottom: 1rem;
        font-size: 0.9rem;
      }

      .celtic-position-emoji {
        margin: 0.5rem 0;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .celtic-position-card {
        font-weight: 600;
        color: var(--color-text);
        font-size: 0.85rem;
        margin-top: 0.5rem;
      }

      @media (max-width: 768px) {
        .card-draw-box.three-card {
          min-width: 100px;
          max-width: 130px;
          padding: 1rem;
        }

        .celtic-grid {
          grid-template-columns: repeat(2, 1fr);
          gap: 1rem;
        }

        .celtic-position {
          padding: 1rem;
        }

        .card-emoji {
          font-size: 3rem;
        }

        .card-name {
          font-size: 1.5rem;
        }
      }

      .footer-links {
        display: flex;
        justify-content: center;
        gap: 2rem;
        margin-top: 1.5rem;
        flex-wrap: wrap;
      }

      .footer-links a {
        color: var(--color-gold);
        text-decoration: none;
        font-size: 0.9rem;
      }

      .footer-links a:hover {
        text-decoration: underline;
      }

      .social-icons {
        margin-top: 2rem;
        font-size: 1.5rem;
        letter-spacing: 1rem;
      }

      /* ===== FAQ ===== */
      .faq-item {
        background: var(--color-white);
        margin-bottom: 1rem;
        border-radius: 8px;
        overflow: hidden;
        border: 1px solid rgba(75, 0, 130, 0.1);
      }

      .faq-question {
        padding: 1.5rem;
        background: var(--color-accent);
        cursor: pointer;
        font-weight: 600;
        color: var(--color-dark-purple);
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: all 0.3s;
      }

      .faq-question:hover {
        background: rgba(75, 0, 130, 0.1);
      }

      .faq-answer {
        padding: 1.5rem;
        color: var(--color-text-light);
        display: none;
        background: var(--color-white);
      }

      .faq-answer.active {
        display: block;
      }

      .faq-icon {
        transition: transform 0.3s;
      }

      .faq-icon.active {
        transform: rotate(180deg);
      }

      /* ===== RESPONSIVE ===== */
      @media (max-width: 768px) {
        .hero h1 {
          font-size: 2.5rem;
        }

        .hero .tagline {
          font-size: 1.1rem;
        }

        .section-title {
          font-size: 1.8rem;
        }

        nav ul {
          gap: 1rem;
        }

        .cards-grid {
          grid-template-columns: 1fr;
        }
      }

      /* ===== ACCESSIBILITY ===== */
      .skip-to-content {
        position: absolute;
        top: -40px;
        left: 0;
        background: var(--color-dark-purple);
        color: var(--color-white);
        padding: 0.5rem 1rem;
        text-decoration: none;
        z-index: 100;
      }

      .skip-to-content:focus {
        top: 0;
      }

      button:focus-visible,
      a:focus-visible {
        outline: 2px solid var(--color-gold);
        outline-offset: 2px;
      }
    </style>
    <!-- Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-XXXXXXXXXX");
    </script>
    <!-- Schema.org Course Structured Data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Course",
        "name": "Escola do Or√°culo - Cursos de Tarot Online",
        "description": "Aprenda Tarot do zero com a Rafaella Kally. Curso completo online com certificado inclu√≠do.",
        "provider": {
          "@type": "Organization",
          "name": "Escola do Or√°culo",
          "sameAs": "https://tesgueira-creator.github.io/escola-do-oraculo-website"
        },
        "courseMode": "online",
        "educationalLevel": "Beginner to Advanced",
        "inLanguage": "pt-PT",
        "hasCourseInstance": [
          {
            "@type": "CourseInstance",
            "courseMode": "online",
            "courseWorkload": "P8W"
          }
        ],
        "offers": {
          "@type": "Offer",
          "category": "Paid",
          "priceCurrency": "EUR",
          "price": "49.00"
        }
      }
    </script>
  </head>
  <body>
    <script>
      // CLIENT AREA PROTECTION & USER INFO
      const token = localStorage.getItem("user_token");
      const userEmail = localStorage.getItem("user_email");

      if (!token) {
        // Redirect to Login if not authenticated
        alert("Acesso restrito ao Templo. Por favor, fa√ßa login.");
        window.location.href = "login.html";
      }

      // API URL configuration
      let API_URL = "https://web-production-21437.up.railway.app";
      if (
        window.location.hostname === "localhost" ||
        window.location.hostname === "127.0.0.1"
      ) {
        API_URL = "http://localhost:8000";
      } else if (window.location.protocol !== "file:") {
        API_URL = window.location.origin;
      }

      // Load user info on page load
      window.addEventListener("DOMContentLoaded", async () => {
        await loadUserInfo();
        await loadDashboardStats();
        await loadUserCourses();
      });

      // Load dashboard statistics
      async function loadDashboardStats() {
        try {
          // Get readings count from localStorage
          const readingsCount = parseInt(localStorage.getItem("readings_count") || "0");
          document.getElementById("stats-readings").textContent = readingsCount;
          
          // Calculate level based on readings
          let level = "Iniciante";
          if (readingsCount >= 100) level = "Mestre";
          else if (readingsCount >= 50) level = "Avan√ßado";
          else if (readingsCount >= 20) level = "Interm√©dio";
          else if (readingsCount >= 5) level = "Aprendiz";
          document.getElementById("stats-level").textContent = level;
          
          // Try to get courses from API
          try {
            const response = await fetch(API_URL + "/users/me/courses", {
              method: "GET",
              headers: {
                "Authorization": "Bearer " + token,
                "Content-Type": "application/json"
              }
            });
            
            if (response.ok) {
              const courses = await response.json();
              document.getElementById("stats-courses").textContent = courses.length || 0;
              document.getElementById("stats-certificates").textContent = courses.filter(c => c.completed).length || 0;
            }
          } catch (e) {
            // API might not have this endpoint yet - use localStorage
            const savedCourses = JSON.parse(localStorage.getItem("user_courses") || "[]");
            document.getElementById("stats-courses").textContent = savedCourses.length;
          }
        } catch (error) {
          console.log("Dashboard stats loaded from local storage");
        }
      }

      // Load user courses
      async function loadUserCourses() {
        const container = document.getElementById("my-courses-container");
        const noCoursesMsg = document.getElementById("no-courses-message");
        
        try {
          // Try API first
          const response = await fetch(API_URL + "/users/me/courses", {
            method: "GET",
            headers: {
              "Authorization": "Bearer " + token,
              "Content-Type": "application/json"
            }
          });
          
          if (response.ok) {
            const courses = await response.json();
            if (courses && courses.length > 0) {
              noCoursesMsg.style.display = "none";
              courses.forEach(course => {
                container.insertAdjacentHTML("beforeend", createCourseCard(course));
              });
            }
          }
        } catch (e) {
          // Check localStorage for demo/saved courses
          const savedCourses = JSON.parse(localStorage.getItem("user_courses") || "[]");
          if (savedCourses.length > 0) {
            noCoursesMsg.style.display = "none";
            savedCourses.forEach(course => {
              container.insertAdjacentHTML("beforeend", createCourseCard(course));
            });
          }
        }
      }

      // Create course card HTML
      function createCourseCard(course) {
        const progress = course.progress || 0;
        return `
          <div style="background: linear-gradient(135deg, rgba(75, 0, 130, 0.05), rgba(197, 160, 89, 0.05)); padding: 1.5rem; border-radius: 12px; border: 2px solid var(--color-gold);">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
              <h4 style="color: var(--color-dark-purple); font-family: var(--font-serif);">${course.name || course.title}</h4>
              <span style="background: ${progress === 100 ? '#4caf50' : 'var(--color-gold)'}; color: ${progress === 100 ? 'white' : 'var(--color-text)'}; padding: 4px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">${progress}%</span>
            </div>
            <div style="background: rgba(0,0,0,0.1); border-radius: 10px; height: 8px; margin-bottom: 1rem;">
              <div style="background: var(--color-gold); height: 100%; border-radius: 10px; width: ${progress}%; transition: width 0.5s;"></div>
            </div>
            <button onclick="window.location.href='${course.url || '#'}'" style="width: 100%; background: var(--color-dark-purple); color: white; border: none; padding: 0.75rem; border-radius: 25px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='var(--color-gold)';this.style.color='var(--color-text)'" onmouseout="this.style.background='var(--color-dark-purple)';this.style.color='white'">
              ${progress === 100 ? 'üìú Ver Certificado' : '‚ñ∂Ô∏è Continuar'}
            </button>
          </div>
        `;
      }

      // Track readings
      function trackReading() {
        const current = parseInt(localStorage.getItem("readings_count") || "0");
        localStorage.setItem("readings_count", (current + 1).toString());
        loadDashboardStats();
      }

      // Load user information
      async function loadUserInfo() {
        try {
          const response = await fetch(API_URL + "/users/me", {
            method: "GET",
            headers: {
              Authorization: "Bearer " + token,
              "Content-Type": "application/json",
            },
          });

          if (response.ok) {
            const userData = await response.json();
            const userName = userData.email.split("@")[0]; // Use email prefix as name
            document.getElementById("user-name").textContent = userName;
            document.getElementById("user-email-display").textContent =
              userData.email;
          } else if (response.status === 401) {
            // Token expired or invalid
            alert("Sess√£o expirada. Por favor, fa√ßa login novamente.");
            handleLogout();
          } else {
            // Fallback to stored email
            if (userEmail) {
              const userName = userEmail.split("@")[0];
              document.getElementById("user-name").textContent = userName;
              document.getElementById("user-email-display").textContent =
                userEmail;
            }
          }
        } catch (error) {
          console.error("Error loading user info:", error);
          // Fallback to stored email
          if (userEmail) {
            const userName = userEmail.split("@")[0];
            document.getElementById("user-name").textContent = userName;
            document.getElementById("user-email-display").textContent =
              userEmail;
          }
        }
      }

      // Toggle user menu dropdown
      function toggleUserMenu() {
        const dropdown = document.getElementById("user-dropdown");
        dropdown.style.display =
          dropdown.style.display === "none" ? "block" : "none";
      }

      // Close dropdown when clicking outside
      document.addEventListener("click", (e) => {
        const userMenu = document.querySelector(".user-menu");
        const dropdown = document.getElementById("user-dropdown");
        if (userMenu && !userMenu.contains(e.target)) {
          dropdown.style.display = "none";
        }
      });

      // Logout function
      function handleLogout() {
        localStorage.removeItem("user_token");
        localStorage.removeItem("user_email");
        alert("At√© breve! ‚ú®");
        window.location.href = "login.html";
      }
    </script>
    <a href="#main-content" class="skip-to-content"
      >Ir para o conte√∫do principal</a
    >

    <!-- NAVIGATION -->
    <nav>
      <div class="logo">
        OR√ÅCULO
        <span class="logo-small">por Rafaella Kally</span>
      </div>
      <button
        class="nav-toggle"
        onclick="toggleMobileMenu()"
        aria-label="Abrir menu de navega√ß√£o"
      >
        ‚ò∞
      </button>
      <ul id="nav-menu">
        <li>
          <a href="../index.html"><strong>üè† Home (M√©todo Kally)</strong></a>
        </li>
        <li><a href="../index.html#cursos">Cursos</a></li>
        <li>
          <a href="#" onclick="location.reload()">üîÑ Reiniciar Or√°culo</a>
        </li>
        <li>
          <div
            class="user-menu"
            style="position: relative; display: inline-block"
          >
            <button
              onclick="toggleUserMenu()"
              style="
                background: rgba(197, 160, 89, 0.1);
                border: 2px solid var(--color-gold);
                border-radius: 50px;
                padding: 8px 15px;
                cursor: pointer;
                color: var(--color-text);
                font-weight: 500;
                display: flex;
                align-items: center;
                gap: 8px;
              "
            >
              <span style="font-size: 1.2rem">üë§</span>
              <span id="user-name">Carregando...</span>
              <span style="font-size: 0.8rem">‚ñº</span>
            </button>
            <div
              id="user-dropdown"
              style="
                display: none;
                position: absolute;
                right: 0;
                top: 45px;
                background: var(--color-white);
                border: 2px solid var(--color-gold);
                border-radius: 10px;
                min-width: 200px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                z-index: 1000;
              "
            >
              <div style="padding: 15px; border-bottom: 1px solid #eee">
                <p
                  style="
                    font-size: 0.85rem;
                    color: var(--color-text-light);
                    margin: 0;
                  "
                >
                  Conectado como
                </p>
                <p
                  id="user-email-display"
                  style="
                    font-weight: bold;
                    margin: 5px 0 0 0;
                    color: var(--color-dark-purple);
                  "
                ></p>
              </div>
              <button
                onclick="smoothScrollTo('#dashboard')"
                style="
                  width: 100%;
                  padding: 12px 15px;
                  background: none;
                  border: none;
                  border-bottom: 1px solid #eee;
                  text-align: left;
                  cursor: pointer;
                  color: var(--color-text);
                  font-weight: 500;
                  display: flex;
                  align-items: center;
                  gap: 8px;
                "
                onmouseover="this.style.background='rgba(75, 0, 130, 0.05)'"
                onmouseout="this.style.background='none'"
              >
                <span>üìä</span> Meu Painel
              </button>
              <button
                onclick="smoothScrollTo('#cursos')"
                style="
                  width: 100%;
                  padding: 12px 15px;
                  background: none;
                  border: none;
                  border-bottom: 1px solid #eee;
                  text-align: left;
                  cursor: pointer;
                  color: var(--color-text);
                  font-weight: 500;
                  display: flex;
                  align-items: center;
                  gap: 8px;
                "
                onmouseover="this.style.background='rgba(75, 0, 130, 0.05)'"
                onmouseout="this.style.background='none'"
              >
                <span>üìö</span> Meus Cursos
              </button>
              <button
                onclick="window.location.href='checkout.html'"
                style="
                  width: 100%;
                  padding: 12px 15px;
                  background: none;
                  border: none;
                  border-bottom: 1px solid #eee;
                  text-align: left;
                  cursor: pointer;
                  color: var(--color-text);
                  font-weight: 500;
                  display: flex;
                  align-items: center;
                  gap: 8px;
                "
                onmouseover="this.style.background='rgba(75, 0, 130, 0.05)'"
                onmouseout="this.style.background='none'"
              >
                <span>üõí</span> Loja
              </button>
              <button
                onclick="handleLogout()"
                style="
                  width: 100%;
                  padding: 12px 15px;
                  background: none;
                  border: none;
                  text-align: left;
                  cursor: pointer;
                  color: #d32f2f;
                  font-weight: 500;
                  display: flex;
                  align-items: center;
                  gap: 8px;
                "
                onmouseover="this.style.background='rgba(211, 47, 47, 0.1)'"
                onmouseout="this.style.background='none'"
              >
                <span>üö™</span> Sair
              </button>
            </div>
          </div>
        </li>
      </ul>
      <button
        class="theme-toggle"
        onclick="toggleTheme()"
        title="Alternar tema"
        aria-label="Alternar entre modo claro e escuro"
      >
        üåô
      </button>
    </nav>

    <!-- HERO SECTION -->
    <section class="hero" id="main-content">
      <h1>Bem-vindo(a) √† √Årea de Membros</h1>
      <p class="tagline">O teu espa√ßo sagrado de aprendizagem</p>
      <!-- Moon Phase Widget -->
      <div
        style="
          background: rgba(212, 165, 116, 0.15);
          border-radius: 8px;
          padding: 1rem;
          margin: 1.5rem 0;
          text-align: center;
          border: 1px solid var(--color-gold);
        "
      >
        <p
          style="
            font-size: 0.9rem;
            color: var(--color-text-light);
            margin-bottom: 0.5rem;
          "
        >
          üåô Fase Lunar de Hoje
        </p>
        <div
          id="moon-phase-display"
          style="
            font-size: 1.5rem;
            margin: 0.5rem 0;
            color: var(--color-dark-purple);
            font-weight: bold;
          "
        >
          Carregando...
        </div>
        <p
          id="moon-date"
          style="
            font-size: 0.85rem;
            color: var(--color-text-light);
            margin: 0.5rem 0;
          "
        ></p>
      </div>
      <p class="subtext">
        Aqui encontras todos os teus cursos, ferramentas exclusivas e recursos
        para a tua jornada no tarot.
      </p>
      <button class="cta-button" onclick="smoothScrollTo('#dashboard')">
        Ver Meus Cursos
      </button>
    </section>

    <!-- ========================================= -->
    <!-- DASHBOARD DE CLIENTE - √ÅREA EXCLUSIVA -->
    <!-- ========================================= -->
    <section class="section" id="dashboard">
      <h2 class="section-title">üìä Meu Painel</h2>
      
      <!-- Stats Cards -->
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 3rem;">
        <div style="background: linear-gradient(135deg, var(--color-dark-purple), #7e2da0); color: white; padding: 2rem; border-radius: 12px; text-align: center;">
          <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">üìö</div>
          <div id="stats-courses" style="font-size: 2rem; font-weight: bold;">0</div>
          <div style="font-size: 0.9rem; opacity: 0.9;">Cursos Ativos</div>
        </div>
        <div style="background: linear-gradient(135deg, var(--color-gold), #d4a574); color: #2c2c2c; padding: 2rem; border-radius: 12px; text-align: center;">
          <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">üîÆ</div>
          <div id="stats-readings" style="font-size: 2rem; font-weight: bold;">0</div>
          <div style="font-size: 0.9rem;">Leituras Realizadas</div>
        </div>
        <div style="background: linear-gradient(135deg, #2e7d32, #4caf50); color: white; padding: 2rem; border-radius: 12px; text-align: center;">
          <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">üèÜ</div>
          <div id="stats-certificates" style="font-size: 2rem; font-weight: bold;">0</div>
          <div style="font-size: 0.9rem; opacity: 0.9;">Certificados</div>
        </div>
        <div style="background: linear-gradient(135deg, #1976d2, #42a5f5); color: white; padding: 2rem; border-radius: 12px; text-align: center;">
          <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">‚≠ê</div>
          <div id="stats-level" style="font-size: 1.5rem; font-weight: bold;">Iniciante</div>
          <div style="font-size: 0.9rem; opacity: 0.9;">Seu N√≠vel</div>
        </div>
      </div>

      <!-- Quick Actions -->
      <div style="background: var(--color-white); border-radius: 12px; padding: 2rem; margin-bottom: 3rem; border: 1px solid rgba(75, 0, 130, 0.1);">
        <h3 style="font-family: var(--font-serif); font-size: 1.5rem; color: var(--color-dark-purple); margin-bottom: 1.5rem;">‚ö° A√ß√µes R√°pidas</h3>
        <div style="display: flex; flex-wrap: wrap; gap: 1rem;">
          <button onclick="smoothScrollTo('#oraculo')" style="background: rgba(75, 0, 130, 0.1); border: 2px solid var(--color-dark-purple); color: var(--color-dark-purple); padding: 1rem 1.5rem; border-radius: 50px; cursor: pointer; font-weight: 600; transition: all 0.3s; display: flex; align-items: center; gap: 8px;" onmouseover="this.style.background='var(--color-dark-purple)';this.style.color='white'" onmouseout="this.style.background='rgba(75, 0, 130, 0.1)';this.style.color='var(--color-dark-purple)'">
            üîÆ Tirar Carta do Dia
          </button>
          <button onclick="smoothScrollTo('#cursos')" style="background: rgba(197, 160, 89, 0.1); border: 2px solid var(--color-gold); color: var(--color-text); padding: 1rem 1.5rem; border-radius: 50px; cursor: pointer; font-weight: 600; transition: all 0.3s; display: flex; align-items: center; gap: 8px;" onmouseover="this.style.background='var(--color-gold)'" onmouseout="this.style.background='rgba(197, 160, 89, 0.1)'">
            üìö Ver Meus Cursos
          </button>
          <button onclick="window.open('https://wa.me/351912345678?text=Ol√° Rafaella, preciso de ajuda', '_blank')" style="background: rgba(37, 211, 102, 0.1); border: 2px solid #25d366; color: #25d366; padding: 1rem 1.5rem; border-radius: 50px; cursor: pointer; font-weight: 600; transition: all 0.3s; display: flex; align-items: center; gap: 8px;" onmouseover="this.style.background='#25d366';this.style.color='white'" onmouseout="this.style.background='rgba(37, 211, 102, 0.1)';this.style.color='#25d366'">
            üí¨ Suporte WhatsApp
          </button>
          <button onclick="window.location.href='checkout.html'" style="background: rgba(211, 47, 47, 0.1); border: 2px solid #d32f2f; color: #d32f2f; padding: 1rem 1.5rem; border-radius: 50px; cursor: pointer; font-weight: 600; transition: all 0.3s; display: flex; align-items: center; gap: 8px;" onmouseover="this.style.background='#d32f2f';this.style.color='white'" onmouseout="this.style.background='rgba(211, 47, 47, 0.1)';this.style.color='#d32f2f'">
            üõí Loja de Cursos
          </button>
        </div>
      </div>

      <!-- My Courses Section -->
      <div style="background: var(--color-white); border-radius: 12px; padding: 2rem; margin-bottom: 3rem; border: 1px solid rgba(75, 0, 130, 0.1);">
        <h3 style="font-family: var(--font-serif); font-size: 1.5rem; color: var(--color-dark-purple); margin-bottom: 1.5rem;">üìö Meus Cursos</h3>
        
        <div id="my-courses-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
          <!-- Empty State -->
          <div id="no-courses-message" style="grid-column: 1 / -1; text-align: center; padding: 3rem; background: rgba(75, 0, 130, 0.03); border-radius: 12px; border: 2px dashed rgba(75, 0, 130, 0.2);">
            <div style="font-size: 4rem; margin-bottom: 1rem;">üìñ</div>
            <h4 style="color: var(--color-dark-purple); margin-bottom: 1rem;">Ainda n√£o tens cursos ativos</h4>
            <p style="color: var(--color-text-light); margin-bottom: 1.5rem;">Come√ßa a tua jornada no tarot hoje mesmo!</p>
            <button onclick="window.location.href='checkout.html'" style="background: var(--color-dark-purple); color: white; border: none; padding: 1rem 2rem; border-radius: 50px; cursor: pointer; font-weight: 600; transition: all 0.3s;" onmouseover="this.style.background='var(--color-gold)';this.style.color='var(--color-text)'" onmouseout="this.style.background='var(--color-dark-purple)';this.style.color='white'">
              Ver Cursos Dispon√≠veis ‚Üí
            </button>
          </div>
        </div>
      </div>

      <!-- Recent Activity -->
      <div style="background: var(--color-white); border-radius: 12px; padding: 2rem; margin-bottom: 3rem; border: 1px solid rgba(75, 0, 130, 0.1);">
        <h3 style="font-family: var(--font-serif); font-size: 1.5rem; color: var(--color-dark-purple); margin-bottom: 1.5rem;">üìÖ Atividade Recente</h3>
        
        <div id="activity-feed" style="display: flex; flex-direction: column; gap: 1rem;">
          <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: rgba(75, 0, 130, 0.03); border-radius: 8px; border-left: 4px solid var(--color-gold);">
            <div style="font-size: 1.5rem;">üéâ</div>
            <div>
              <div style="font-weight: 600; color: var(--color-dark-purple);">Bem-vindo(a) √† Escola do Or√°culo!</div>
              <div style="font-size: 0.85rem; color: var(--color-text-light);">Agora mesmo</div>
            </div>
          </div>
          <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: rgba(75, 0, 130, 0.03); border-radius: 8px; border-left: 4px solid var(--color-dark-purple);">
            <div style="font-size: 1.5rem;">‚ú®</div>
            <div>
              <div style="font-weight: 600; color: var(--color-dark-purple);">Dica: Tira a tua carta do dia!</div>
              <div style="font-size: 0.85rem; color: var(--color-text-light);">Usa o Or√°culo interativo abaixo</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Resources Section -->
      <div style="background: linear-gradient(135deg, rgba(75, 0, 130, 0.05), rgba(197, 160, 89, 0.05)); border-radius: 12px; padding: 2rem; margin-bottom: 3rem;">
        <h3 style="font-family: var(--font-serif); font-size: 1.5rem; color: var(--color-dark-purple); margin-bottom: 1.5rem;">üéÅ Recursos Exclusivos</h3>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
          <div style="background: var(--color-white); padding: 1.5rem; border-radius: 10px; border: 1px solid rgba(75, 0, 130, 0.1); text-align: center;">
            <div style="font-size: 2.5rem; margin-bottom: 1rem;">üìò</div>
            <h4 style="color: var(--color-dark-purple); margin-bottom: 0.5rem;">Guia de Significados</h4>
            <p style="font-size: 0.9rem; color: var(--color-text-light); margin-bottom: 1rem;">78 cartas explicadas</p>
            <button onclick="alert('Em breve! Estamos preparando este conte√∫do exclusivo.')" style="background: var(--color-gold); border: none; padding: 0.75rem 1.5rem; border-radius: 25px; cursor: pointer; font-weight: 600;">Download PDF</button>
          </div>
          <div style="background: var(--color-white); padding: 1.5rem; border-radius: 10px; border: 1px solid rgba(75, 0, 130, 0.1); text-align: center;">
            <div style="font-size: 2.5rem; margin-bottom: 1rem;">üé¨</div>
            <h4 style="color: var(--color-dark-purple); margin-bottom: 0.5rem;">Aulas B√≥nus</h4>
            <p style="font-size: 0.9rem; color: var(--color-text-light); margin-bottom: 1rem;">Conte√∫do extra gratuito</p>
            <button onclick="alert('Em breve! Estamos preparando este conte√∫do exclusivo.')" style="background: var(--color-gold); border: none; padding: 0.75rem 1.5rem; border-radius: 25px; cursor: pointer; font-weight: 600;">Ver Aulas</button>
          </div>
          <div style="background: var(--color-white); padding: 1.5rem; border-radius: 10px; border: 1px solid rgba(75, 0, 130, 0.1); text-align: center;">
            <div style="font-size: 2.5rem; margin-bottom: 1rem;">üë•</div>
            <h4 style="color: var(--color-dark-purple); margin-bottom: 0.5rem;">Comunidade Privada</h4>
            <p style="font-size: 0.9rem; color: var(--color-text-light); margin-bottom: 1rem;">Grupo exclusivo de alunos</p>
            <button onclick="window.open('https://t.me/escoladooraculo', '_blank')" style="background: var(--color-gold); border: none; padding: 0.75rem 1.5rem; border-radius: 25px; cursor: pointer; font-weight: 600;">Entrar no Grupo</button>
          </div>
          <div style="background: var(--color-white); padding: 1.5rem; border-radius: 10px; border: 1px solid rgba(75, 0, 130, 0.1); text-align: center;">
            <div style="font-size: 2.5rem; margin-bottom: 1rem;">üìÖ</div>
            <h4 style="color: var(--color-dark-purple); margin-bottom: 0.5rem;">Lives Mensais</h4>
            <p style="font-size: 0.9rem; color: var(--color-text-light); margin-bottom: 1rem;">Sess√µes ao vivo com Rafaella</p>
            <button onclick="alert('Pr√≥xima live: Em breve! Receber√°s um email com a data.')" style="background: var(--color-gold); border: none; padding: 0.75rem 1.5rem; border-radius: 25px; cursor: pointer; font-weight: 600;">Agendar Lembrete</button>
          </div>
        </div>
      </div>
    </section>

    <!-- OR√ÅCULO INTERATIVO -->
    <section class="section" id="oraculo">
      <h2 class="section-title">üîÆ Or√°culo Interativo</h2>
    </section>

    <!-- INTERACTIVE CARD DRAW -->
    <div class="section" role="region" aria-label="Leitor de tarot interativo">
      <div class="card-draw-container">
        <h3>‚ú® Mensagem do Dia ‚ú®</h3>
        <p style="color: var(--color-text-light); margin-bottom: 1.5rem">
          Escolha um tipo de leitura
        </p>

        <!-- Reading Type Selector -->
        <div
          style="
            margin-bottom: 2rem;
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
          "
          role="tablist"
          aria-label="Tipos de leitura"
        >
          <button
            class="reading-type-btn active"
            onclick="setReadingType('daily', this)"
            role="tab"
            aria-selected="true"
            aria-controls="daily-reading"
          >
            Mensagem do Dia
          </button>
          <button
            class="reading-type-btn"
            onclick="setReadingType('three', this)"
            role="tab"
            aria-selected="false"
            aria-controls="three-reading"
          >
            Tirada 3 Cartas
          </button>
          <button
            class="reading-type-btn"
            onclick="setReadingType('celtic', this)"
            role="tab"
            aria-selected="false"
            aria-controls="celtic-reading"
          >
            Cruz Celta
          </button>
        </div>

        <!-- Chakra Spread -->
        <div
          id="chakra-reading"
          class="reading-container"
          style="display: none"
          role="tabpanel"
          aria-labelledby="chakra-tab"
        >
          <p style="color: var(--color-text-light); margin-bottom: 1.5rem">
            A Leitura de Chakras alinha as 7 energias do teu corpo (Root,
            Sacral, Solar, Heart, Throat, Third Eye, Crown)
          </p>
          <button
            class="cta-button"
            style="margin-top: 1.5rem"
            onclick="drawChakraSpread()"
            aria-label="Tirar cartas para leitura dos 7 chakras"
          >
            Ativar Leitura de Chakras
          </button>
          <div
            id="chakra-result"
            class="chakra-cards-grid"
            style="display: none; margin-top: 2rem"
            role="region"
            aria-live="polite"
            aria-label="Resultado da leitura de chakras"
          ></div>
        </div>
        <!-- Daily Reading -->
        <div
          id="daily-reading"
          class="reading-container"
          style="display: block"
          role="tabpanel"
          aria-labelledby="daily-tab"
        >
          <button
            class="card-draw-box"
            onclick="drawCard('daily')"
            aria-label="Clique para tirar uma carta do dia"
          >
            <div class="card-result">
              <img
                src="/backend/art/78.webp"
                alt="Carta"
                class="card-back-img"
                onerror="this.src='https://via.placeholder.com/120x180?text=Carta'"
              />
            </div>
            <p style="color: var(--color-text-light)">
              Clique para tirar uma carta
            </p>
          </button>
          <div
            id="daily-result"
            class="card-display"
            style="display: none; margin-top: 2rem"
            role="region"
            aria-live="polite"
            aria-label="Resultado da carta do dia"
          ></div>
        </div>

        <!-- Three Card Reading -->
        <div
          id="three-reading"
          class="reading-container"
          style="display: none"
          role="tabpanel"
          aria-labelledby="three-tab"
        >
          <div
            style="
              display: flex;
              gap: 1rem;
              justify-content: center;
              flex-wrap: wrap;
            "
          >
            <button
              class="card-draw-box three-card"
              onclick="drawThreeCards()"
              aria-label="Passado"
            >
              <div class="card-result">
                <img
                  src="/backend/art/78.webp"
                  alt="Carta"
                  class="card-back-img"
                  onerror="this.src='https://via.placeholder.com/120x180?text=Carta'"
                />
              </div>
              <p style="color: var(--color-text-light)">Passado</p>
            </button>
            <button
              class="card-draw-box three-card"
              onclick="drawThreeCards()"
              aria-label="Presente"
            >
              <div class="card-result">
                <img
                  src="/backend/art/78.webp"
                  alt="Carta"
                  class="card-back-img"
                  onerror="this.src='https://via.placeholder.com/120x180?text=Carta'"
                />
              </div>
              <p style="color: var(--color-text-light)">Presente</p>
            </button>
            <button
              class="card-draw-box three-card"
              onclick="drawThreeCards()"
              aria-label="Futuro"
            >
              <div class="card-result">
                <img
                  src="/backend/art/78.webp"
                  alt="Carta"
                  class="card-back-img"
                  onerror="this.src='https://via.placeholder.com/120x180?text=Carta'"
                />
              </div>
              <p style="color: var(--color-text-light)">Futuro</p>
            </button>
          </div>
          <button
            class="cta-button"
            style="margin-top: 1.5rem"
            onclick="drawThreeCards()"
            aria-label="Tirar 3 cartas para leitura de Passado, Presente e Futuro"
          >
            Tirar 3 Cartas
          </button>
          <div
            id="three-result"
            class="card-display-three"
            style="display: none; margin-top: 2rem"
            role="region"
            aria-live="polite"
            aria-label="Resultado da tirada de 3 cartas"
          ></div>
        </div>

        <!-- Celtic Cross -->
        <div
          id="celtic-reading"
          class="reading-container"
          style="display: none"
          role="tabpanel"
          aria-labelledby="celtic-tab"
        >
          <p style="color: var(--color-text-light); margin-bottom: 1.5rem">
            A Cruz Celta revela 10 camadas de influ√™ncia (posi√ß√µes 1-10)
          </p>
          <button
            class="cta-button"
            style="margin-bottom: 1.5rem"
            onclick="drawCelticCross()"
            aria-label="Fazer leitura da Cruz Celta com 10 posi√ß√µes"
          >
            Fazer Leitura da Cruz Celta
          </button>
          <div
            id="celtic-result"
            class="card-display-celtic"
            style="display: none"
            role="region"
            aria-live="polite"
            aria-label="Resultado da Cruz Celta"
          ></div>
        </div>
      </div>
    </div>

    <!-- CURSOS SECTION -->
    <section class="section" id="cursos">
      <h2 class="section-title">Os Nossos Cursos</h2>

      <div class="cards-grid">
        <!-- M√ìDULO 1 -->
        <div class="card">
          <div class="card-icon">üìö</div>
          <h3>M√≥dulo 1: A Base do Or√°culo</h3>
          <p>
            Domine os 22 Arcanos Maiores e os 4 Naipes. Aprenda a hist√≥ria por
            tr√°s de cada carta de forma memor√°vel.
          </p>
          <div class="card-price">
            <span class="card-price-old">‚Ç¨49</span>‚Ç¨29
          </div>
          <p
            style="
              font-size: 0.9rem;
              color: var(--color-text-light);
              margin-bottom: 1rem;
            "
          >
            ‚è±Ô∏è 8-10 horas de conte√∫do | üìñ Dicion√°rio Kally inclu√≠do
          </p>
          <a
            href="modulo-1.html"
            class="cta-button"
            style="text-decoration: none; display: inline-block"
          >
            Saber Mais
          </a>
        </div>

        <!-- M√ìDULO 2 -->
        <div class="card">
          <div class="card-icon">üîÆ</div>
          <h3>M√≥dulo 2: O M√©todo Kally</h3>
          <p>
            Pr√°tica intensiva. Domine as 3 tiradas principais e desenvolva sua
            intui√ß√£o com o m√©todo exclusivo de Rafaella.
          </p>
          <div class="card-price">
            <span class="card-price-old">‚Ç¨79</span>‚Ç¨49
          </div>
          <p
            style="
              font-size: 0.9rem;
              color: var(--color-text-light);
              margin-bottom: 1rem;
            "
          >
            ‚è±Ô∏è 10-12 horas | üë• Comunidade inclu√≠da
          </p>
          <a
            href="modulo-2.html"
            class="cta-button"
            style="text-decoration: none; display: inline-block"
          >
            Saber Mais
          </a>
        </div>

        <!-- M√ìDULO 3 -->
        <div class="card">
          <div class="card-icon">üíº</div>
          <h3>M√≥dulo 3: Profissionaliza√ß√£o</h3>
          <p>
            Prepare-se para consultar clientes. Marketing, pre√ßos, ferramentas e
            como estruturar seu neg√≥cio de tarot.
          </p>
          <div class="card-price">
            <span class="card-price-old">‚Ç¨99</span>‚Ç¨69
          </div>
          <p
            style="
              font-size: 0.9rem;
              color: var(--color-text-light);
              margin-bottom: 1rem;
            "
          >
            ‚è±Ô∏è 12-14 horas | üì± Templates prontos
          </p>
          <a
            href="modulo-3.html"
            class="cta-button"
            style="text-decoration: none; display: inline-block"
          >
            Saber Mais
          </a>
        </div>

        <!-- BUNDLE -->
        <div
          class="card"
          style="
            background: linear-gradient(
              135deg,
              var(--color-dark-purple),
              rgba(75, 0, 130, 0.8)
            );
            color: var(--color-white);
            grid-column: span 1;
          "
        >
          <div class="card-icon">üåü</div>
          <h3 style="color: var(--color-white)">Bundle Completo</h3>
          <p style="color: rgba(255, 255, 255, 0.9)">
            Todos os 3 m√≥dulos + Certificado Digital + Comunidade Exclusiva
            "C√≠rculo do Or√°culo" + B√≥nus.
          </p>
          <div
            style="
              color: var(--color-gold);
              font-size: 2rem;
              font-weight: bold;
              margin: 1rem 0;
            "
          >
            <span
              style="
                text-decoration: line-through;
                font-size: 1.3rem;
                opacity: 0.8;
              "
              >‚Ç¨227</span
            ><br />‚Ç¨129
          </div>
          <p
            style="
              font-size: 0.85rem;
              color: rgba(255, 255, 255, 0.8);
              margin-bottom: 1rem;
            "
          >
            üéÅ Save ‚Ç¨98! | ‚è±Ô∏è 30-36 horas de conte√∫do
          </p>
          <button
            style="
              background: var(--color-gold);
              color: var(--color-text);
              border: none;
              padding: 1rem 2.5rem;
              border-radius: 50px;
              font-weight: 600;
              cursor: pointer;
              transition: all 0.3s;
              text-decoration: none;
            "
            onclick="window.location.href='checkout.html'"
          >
            Inscrever Agora
          </button>
        </div>
      </div>
    </section>

    <!-- SOBRE SECTION -->
    <section class="section" id="sobre">
      <h2 class="section-title">Quem √© Rafaella Kally?</h2>
      <div class="about">
        <div class="about-text">
          <h2>Tar√≥loga & Educadora Especializada</h2>
          <p>
            Com mais de 10 anos de experi√™ncia em leitura de tarot, Rafaella
            desenvolveu o "M√©todo Kally" ‚Äì uma abordagem que combina
            conhecimento tradicional com pr√°tica intuitiva moderna.
          </p>
          <p>
            Sua miss√£o √© desmistificar o tarot e formar tar√≥logos √©ticos,
            capazes de ajudar verdadeiramente seus clientes sem promessas falsas
            ou manipula√ß√£o.
          </p>
          <p>
            J√° formou alunos em Portugal e Brasil, muitos dos quais hoje
            consultam com mais seguran√ßa e estrutura.
          </p>
        </div>
        <div class="about-image">üë©‚Äçüè´</div>
      </div>
    </section>

    <!-- TESTIMONIALS -->
    <section class="section">
      <h2 class="section-title">O Que Dizem Nossos Alunos</h2>

      <div class="testimonial">
        <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
        <p class="testimonial-text">
          "Antes eu tinha medo de come√ßar. Depois do M√≥dulo 1, entendi que o
          tarot pode ser acess√≠vel e bem explicado. Me senti mais segura para
          praticar."
        </p>
        <p class="testimonial-author">Sofia M.</p>
        <p class="testimonial-role">Lisboa, PT</p>
      </div>

      <div class="testimonial">
        <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
        <p class="testimonial-text">
          "O M√≥dulo 3 mudou a forma como eu organizo minhas leituras. Passei a
          atender online com mais confian√ßa e consist√™ncia. Rafaella foca em
          ferramentas pr√°ticas e responsabilidade."
        </p>
        <p class="testimonial-author">Ana C.</p>
        <p class="testimonial-role">S√£o Paulo, BR</p>
      </div>

      <div class="testimonial">
        <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
        <p class="testimonial-text">
          "Gostei muito da qualidade do conte√∫do. Os v√≠deos s√£o bem produzidos,
          objetivos e com boa did√°tica. D√° para ver cuidado e consist√™ncia no
          m√©todo."
        </p>
        <p class="testimonial-author">Miguel R.</p>
        <p class="testimonial-role">Porto, PT</p>
      </div>
    </section>

    <!-- C√çRCULO DO OR√ÅCULO -->
    <section class="section" id="circulo">
      <h2 class="section-title">C√≠rculo do Or√°culo</h2>
      <div class="card" style="text-align: center">
        <h3>Comunidade Exclusiva (‚Ç¨15/m√™s)</h3>
        <p style="margin: 1.5rem 0; font-size: 1.1rem">
          Acesso ao grupo privado Telegram com mentorias ao vivo, partilha de
          cases, e networking com outros tar√≥logos formados pela escola.
        </p>
        <div
          style="
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin: 2rem 0;
          "
        >
          <div>
            <p style="font-size: 1.5rem">üéØ</p>
            <p style="font-weight: 600">Mentorias Semanais</p>
          </div>
          <div>
            <p style="font-size: 1.5rem">üë•</p>
            <p style="font-weight: 600">Networking Ativo</p>
          </div>
          <div>
            <p style="font-size: 1.5rem">üìö</p>
            <p style="font-weight: 600">Recursos Cont√≠nuos</p>
          </div>
        </div>
        <button
          class="cta-button"
          onclick="window.location.href='circulo.html'"
        >
          Saber Mais Sobre C√≠rculo
        </button>
      </div>
    </section>

    <!-- POL√çTICA / TERMOS (√ÇNCORAS DO FOOTER) -->
    <section class="section" id="politica">
      <h2 class="section-title">Pol√≠tica de Privacidade</h2>
      <div class="card">
        <p>
          Esta p√°gina √© uma vers√£o resumida e informativa. Os dados enviados via
          email (ex.: pedido de informa√ß√µes/inscri√ß√£o) s√£o usados apenas para
          responder ao seu contacto e dar seguimento ao seu pedido.
        </p>
        <p style="margin-top: 1rem">
          Para pedir remo√ß√£o/altera√ß√£o de dados ou esclarecer d√∫vidas, contacte:
          <a href="mailto:contacto@rafaellakally.com"
            >contacto@rafaellakally.com</a
          >.
        </p>
      </div>
    </section>

    <section class="section" id="termos">
      <h2 class="section-title">Termos e Condi√ß√µes</h2>
      <div class="card">
        <p>
          As informa√ß√µes deste site t√™m car√°cter educativo. Resultados variam
          conforme dedica√ß√£o, contexto e experi√™ncia pr√©via.
        </p>
        <p style="margin-top: 1rem">
          Para informa√ß√µes oficiais sobre inscri√ß√£o, pagamentos e acesso, fale
          connosco em
          <a href="mailto:contacto@rafaellakally.com"
            >contacto@rafaellakally.com</a
          >.
        </p>
      </div>
    </section>

    <!-- FAQ -->
    <section class="section" id="faq">
      <h2 class="section-title">Perguntas Frequentes</h2>

      <div class="faq-item">
        <div class="faq-question" onclick="toggleFaq(this)">
          <span>Preciso ter experi√™ncia pr√©via com tarot?</span>
          <span class="faq-icon">‚ñº</span>
        </div>
        <div class="faq-answer">
          N√£o! Os cursos come√ßam do zero. Se j√° l√™ tarot, come√ßar√° no M√≥dulo 2
          ou 3 para aprofundar. O M√≥dulo 1 √© acess√≠vel para iniciantes
          absolutos.
        </div>
      </div>

      <div class="faq-item">
        <div class="faq-question" onclick="toggleFaq(this)">
          <span>Qual √© o formato dos cursos?</span>
          <span class="faq-icon">‚ñº</span>
        </div>
        <div class="faq-answer">
          V√≠deos pr√©-gravados (10-15 min cada), acess√≠veis 24/7. Sem aulas ao
          vivo obrigat√≥rias. Voc√™ estuda no seu ritmo, sem prazos.
        </div>
      </div>

      <div class="faq-item">
        <div class="faq-question" onclick="toggleFaq(this)">
          <span>O certificado √© reconhecido oficialmente?</span>
          <span class="faq-icon">‚ñº</span>
        </div>
        <div class="faq-answer">
          O certificado √© emitido por Rafaella Kally ‚Äî Escola do Or√°culo e
          reconhece a conclus√£o do curso. N√£o √© uma qualifica√ß√£o estatal
          (DGERT), mas tem valor de mercado entre clientes e √© amplamente aceite
          no LinkedIn.
        </div>
      </div>

      <div class="faq-item">
        <div class="faq-question" onclick="toggleFaq(this)">
          <span>Quanto tempo leva para completar?</span>
          <span class="faq-icon">‚ñº</span>
        </div>
        <div class="faq-answer">
          Cada m√≥dulo leva aproximadamente 4 semanas se estudar 1-2 horas por
          semana. Voc√™ pode ir mais r√°pido ou mais lento conforme sua agenda.
        </div>
      </div>

      <div class="faq-item">
        <div class="faq-question" onclick="toggleFaq(this)">
          <span>H√° garantia de reembolso?</span>
          <span class="faq-icon">‚ñº</span>
        </div>
        <div class="faq-answer">
          Sim! Se n√£o estiver satisfeito nos primeiros 7 dias, devolvemos 100%
          do valor. Nenhuma pergunta feita.
        </div>
      </div>
    </section>

    <!-- FOOTER -->
    <footer id="contacto" role="contentinfo">
      <h3 style="margin-bottom: 1rem">Escola do Or√°culo</h3>
      <p>Cursos de Tarot Online ‚Ä¢ Portugal + Brasil</p>

      <div class="footer-links">
        <a href="politica-privacidade.html" rel="help"
          >Pol√≠tica de Privacidade</a
        >
        <a href="termos-condicoes.html" rel="help">Termos e Condi√ß√µes</a>
        <a href="mailto:contacto@rafaellakally.com" rel="contact">
          Email: contacto@rafaellakally.com
        </a>
      </div>

      <div class="social-icons" role="navigation" aria-label="Redes sociais">
        <a
          href="https://www.instagram.com/tarostesia?igsh=MXZjZjBpdXFmend6aA=="
          target="_blank"
          rel="noopener noreferrer"
          aria-label="Siga-nos no Instagram"
          title="Instagram - @tarostesia"
        >
          üì∑
        </a>
        <span aria-hidden="true" style="margin: 0 0.5rem">üì± üé•</span>
      </div>

      <p style="margin-top: 2rem; font-size: 0.9rem; opacity: 0.8">
        ¬© 2026 Escola do Or√°culo por Rafaella Kally. Todos os direitos
        reservados.
      </p>
    </footer>

    <script>
      // ===== DARK MODE TOGGLE =====
      function toggleTheme() {
        const html = document.documentElement;
        const isDark = html.getAttribute("data-theme") === "dark";
        html.setAttribute("data-theme", isDark ? "light" : "dark");
        localStorage.setItem("theme", isDark ? "light" : "dark");
        updateThemeButton();
      }
      // Alias for backwards compatibility
      const toggleDarkMode = toggleTheme;

      function updateThemeButton() {
        const html = document.documentElement;
        const isDark = html.getAttribute("data-theme") === "dark";
        const btn = document.querySelector(".theme-toggle");
        if (btn) {
          btn.textContent = isDark ? "‚òÄÔ∏è" : "üåô";
          btn.title = isDark ? "Modo claro" : "Modo escuro";
        }
      }

      // Load theme preference on page load
      window.addEventListener("load", () => {
        const savedTheme = localStorage.getItem("theme") || "light";
        document.documentElement.setAttribute("data-theme", savedTheme);
        updateThemeButton();
      });

      // ===== MOBILE MENU TOGGLE =====
      function toggleMobileMenu() {
        const menu = document.getElementById("nav-menu");
        menu.classList.toggle("active");
      }

      function closeMobileMenu() {
        const menu = document.getElementById("nav-menu");
        menu.classList.remove("active");
      }

      // Close mobile menu when clicking outside
      document.addEventListener("click", (e) => {
        const nav = document.querySelector("nav");
        const toggle = document.querySelector(".nav-toggle");
        if (!nav.contains(e.target) && !toggle.contains(e.target)) {
          closeMobileMenu();
        }
      });

      // ===== COMPLETE TAROT CARD BANK =====
      const tarotCards = {
        majorArcana: [
          {
            id: 0,
            name: "O Louco",
            emoji: "üÉè",
            number: "0",
            element: "Ar",
            upright:
              "Novos come√ßos, inoc√™ncia, espontaneidade, potencial ilimitado",
            reversed: "Impulsividade, falta de reflex√£o, atos precipitados",
            meaning:
              "Representa o esp√≠rito aventureiro e a disposi√ß√£o para tomar riscos calculados.",
          },
          {
            id: 1,
            name: "O Mago",
            emoji: "ü™Ñ",
            number: "I",
            element: "Merc√∫rio",
            upright: "Poder, maestria, recursos, inspira√ß√£o, poder pessoal",
            reversed: "Manipula√ß√£o, falta de poder, indecis√£o",
            meaning:
              "S√≠mbolo do potencial humano e da capacidade de manifesta√ß√£o.",
          },
          {
            id: 2,
            name: "A Sacerdotisa",
            emoji: "üëë",
            number: "II",
            element: "Lua",
            upright: "Intui√ß√£o, know, divino feminino, subconsciente",
            reversed: "Ignor√¢ncia, revela√ß√£o, frieza emocional",
            meaning:
              "Acesso aos mist√©rios do subconsciente e da sabedoria interior.",
          },
          {
            id: 3,
            name: "A Imperatriz",
            emoji: "üå∏",
            number: "III",
            element: "V√©nus",
            upright:
              "Fertilidade, beleza, abund√¢ncia, criatividade, sensualidade",
            reversed: "Infertilidade, neglig√™ncia, falta de cuidado",
            meaning:
              "Energia criativa e geradora, ligada √† maternidade e crescimento.",
          },
          {
            id: 4,
            name: "O Imperador",
            emoji: "üë®‚Äç‚öñÔ∏è",
            number: "IV",
            element: "√Åries",
            upright: "Autoridade, estrutura, poder, controle, paternidade",
            reversed: "Tirania, impot√™ncia, imaturidade",
            meaning: "Ordem, estrutura e lideran√ßa estabelecida.",
          },
          {
            id: 5,
            name: "O Papa",
            emoji: "üìø",
            number: "V",
            element: "Touro",
            upright: "Tradi√ß√£o, conformidade, moralidade, √©tica, ensino",
            reversed: "Dogmatismo, ingenuidade, resist√™ncia √† mudan√ßa",
            meaning: "Orienta√ß√£o espiritual e busca pelo conhecimento sagrado.",
          },
          {
            id: 6,
            name: "Os Apaixonados",
            emoji: "üíï",
            number: "VI",
            element: "G√©meos",
            upright: "Amor, harmonia, relacionamentos, valores, escolhas",
            reversed: "Desarmonia, confus√£o, conflito emocional",
            meaning:
              "Decis√µes importantes sobre relacionamentos e valores pessoais.",
          },
          {
            id: 7,
            name: "O Carro",
            emoji: "üöó",
            number: "VII",
            element: "Caranguejo",
            upright: "Controle, movimento, determina√ß√£o, vontade, vit√≥ria",
            reversed: "Falta de controle, agress√£o, frustra√ß√£o",
            meaning: "Progresso atrav√©s de for√ßa de vontade e determina√ß√£o.",
          },
          {
            id: 8,
            name: "A For√ßa",
            emoji: "üí™",
            number: "VIII",
            element: "Le√£o",
            upright: "For√ßa interior, coragem, paci√™ncia, controle",
            reversed: "Fraqueza, inseguran√ßa, falta de confian√ßa",
            meaning: "Poder gentil e dom√≠nio sobre instintos primitivos.",
          },
          {
            id: 9,
            name: "O Eremita",
            emoji: "üî¶",
            number: "IX",
            element: "Virgem",
            upright: "Sabedoria, introspec√ß√£o, isolamento, procura interior",
            reversed: "Solid√£o, isolamento, recusa de ajuda",
            meaning: "Jornada de auto-descoberta e ilumina√ß√£o espiritual.",
          },
          {
            id: 10,
            name: "A Roda da Fortuna",
            emoji: "üé°",
            number: "X",
            element: "J√∫piter",
            upright: "Boa sorte, ciclos, destino, viragem",
            reversed: "M√° sorte, resist√™ncia ao mudan√ßa, falta de controle",
            meaning: "Ciclos naturais da vida e mudan√ßas inevit√°veis.",
          },
          {
            id: 11,
            name: "A Justi√ßa",
            emoji: "‚öñÔ∏è",
            number: "XI",
            element: "Libra",
            upright: "Justi√ßa, equil√≠brio, verdade, causa e efeito",
            reversed: "Injusti√ßa, desequil√≠brio, preconceito",
            meaning: "Responsabilidade e consequ√™ncias das a√ß√µes.",
          },
          {
            id: 12,
            name: "O Enforcado",
            emoji: "üîó",
            number: "XII",
            element: "Neptuno",
            upright: "Suspens√£o, restri√ß√£o, deixar ir, perspectiva",
            reversed: "Resist√™ncia, apego, falta de perspectiva",
            meaning: "Sacrif√≠cio tempor√°rio para ganho espiritual.",
          },
          {
            id: 13,
            name: "A Morte",
            emoji: "üíÄ",
            number: "XIII",
            element: "Escorpi√£o",
            upright: "Transforma√ß√£o, encerramento, novo come√ßo, transi√ß√£o",
            reversed: "Estagna√ß√£o, resist√™ncia √† mudan√ßa, medo",
            meaning: "Transi√ß√£o e transforma√ß√£o necess√°ria para crescimento.",
          },
          {
            id: 14,
            name: "A Temperan√ßa",
            emoji: "‚öóÔ∏è",
            number: "XIV",
            element: "Sagit√°rio",
            upright: "Equil√≠brio, modera√ß√£o, paci√™ncia, harmonia",
            reversed: "Desequil√≠brio, excesso, falta de paci√™ncia",
            meaning: "Busca pelo equil√≠brio e modera√ß√£o em todas as coisas.",
          },
          {
            id: 15,
            name: "O Diabo",
            emoji: "üòà",
            number: "XV",
            element: "Capric√≥rnio",
            upright: "Escravatura, materialismo, sexualidade, liberdade negada",
            reversed: "Liberta√ß√£o, liberta√ß√£o, empoderamento",
            meaning: "Confronto com limita√ß√µes e desejos carnais.",
          },
          {
            id: 16,
            name: "A Torre",
            emoji: "üèöÔ∏è",
            number: "XVI",
            element: "Marte",
            upright: "Destrui√ß√£o, colapso, revela√ß√£o, epifania",
            reversed: "Recupera√ß√£o lenta, evitar desastre",
            meaning: "Desintegra√ß√£o necess√°ria para reconstru√ß√£o.",
          },
          {
            id: 17,
            name: "A Estrela",
            emoji: "‚≠ê",
            number: "XVII",
            element: "Aqu√°rio",
            upright: "Esperan√ßa, f√©, renova√ß√£o, espiritualidade",
            reversed: "Desespero, perda de f√©, desilus√£o",
            meaning: "Guia celestial para inspira√ß√£o e dire√ß√£o.",
          },
          {
            id: 18,
            name: "A Lua",
            emoji: "üåô",
            number: "XVIII",
            element: "Peixes",
            upright: "Ilus√£o, medo, intui√ß√£o, inconsciente",
            reversed: "Clareza, alerta, verdade revelada",
            meaning: "Explora√ß√£o de medos e da mente subconsciente.",
          },
          {
            id: 19,
            name: "O Sol",
            emoji: "‚òÄÔ∏è",
            number: "XIX",
            element: "Sol",
            upright: "Sucesso, alegria, vitalidade, otimismo",
            reversed: "Sombra, atraso, incerteza",
            meaning: "Claridade, energia positiva e ilumina√ß√£o.",
          },
          {
            id: 20,
            name: "O Julgamento",
            emoji: "üìØ",
            number: "XX",
            element: "Plut√£o",
            upright: "Reckoning, despertar, chamada, renova√ß√£o",
            reversed: "Auto-d√∫vida, falta de clareza, adiamento",
            meaning: "Avalia√ß√£o e chamado para um n√≠vel superior.",
          },
          {
            id: 21,
            name: "O Mundo",
            emoji: "üåç",
            number: "XXI",
            element: "Saturno",
            upright: "Conclus√£o, cumprimento, viagem, encerramento",
            reversed: "Incompletude, busca cont√≠nua",
            meaning: "Ciclo completo e totalidade alcan√ßada.",
          },
        ],
        minorArcana: {
          copas: [
            {
              name: "√Ås de Copas",
              suit: "Copas",
              emoji: "üèÜ",
              meaning: "Novo come√ßo emocional, oferecimento, oportunidade",
            },
            {
              name: "Dois de Copas",
              emoji: "üíë",
              meaning: "Parceria, uni√£o, relacionamento harmonioso",
            },
            {
              name: "Tr√™s de Copas",
              emoji: "üéâ",
              meaning: "Celebra√ß√£o, comunidade, amizade, alegria",
            },
            {
              name: "Quatro de Copas",
              emoji: "ü§î",
              meaning: "Apatia, reflex√£o, reavalia√ß√£o",
            },
            {
              name: "Cinco de Copas",
              emoji: "üò¢",
              meaning: "Perda, tristeza, desapontamento, remorso",
            },
            {
              name: "Seis de Copas",
              emoji: "üéÅ",
              meaning: "Nostalgia, generosidade, inoc√™ncia",
            },
            {
              name: "Sete de Copas",
              emoji: "üí≠",
              meaning: "Ilus√£o, fantasia, confus√£o de escolhas",
            },
            {
              name: "Oito de Copas",
              emoji: "üö∂",
              meaning: "Abandono, partida, busca de significado",
            },
            {
              name: "Nove de Copas",
              emoji: "üòä",
              meaning: "Desejo realizado, satisfa√ß√£o, contentamento",
            },
            {
              name: "Dez de Copas",
              emoji: "üë®‚Äçüë©‚Äçüëß‚Äçüë¶",
              meaning: "Harmonia familiar, felicidade dom√©stica",
            },
            {
              name: "Pajem de Copas",
              emoji: "üßí",
              meaning: "Juventude, intelig√™ncia emocional, sensibilidade",
            },
            {
              name: "Cavaleiro de Copas",
              emoji: "üé≠",
              meaning: "Romance, convite, sedu√ß√£o",
            },
            {
              name: "Rainha de Copas",
              emoji: "üë∏",
              meaning: "Intui√ß√£o, compaix√£o, empatia",
            },
            {
              name: "Rei de Copas",
              emoji: "üëë",
              meaning: "Empatia, compreens√£o, energia emocional",
            },
          ],
          ouros: [
            {
              name: "√Ås de Ouros",
              suit: "Ouros",
              emoji: "üíé",
              meaning: "Abund√¢ncia, prosperidade, oportunidade financeira",
            },
            {
              name: "Dois de Ouros",
              emoji: "‚öñÔ∏è",
              meaning: "Equilibrio, adaptabilidade, flexibilidade",
            },
            {
              name: "Tr√™s de Ouros",
              emoji: "üèóÔ∏è",
              meaning: "Colabora√ß√£o, trabalho em equipa, mestria",
            },
            {
              name: "Quatro de Ouros",
              emoji: "üîê",
              meaning: "Seguran√ßa, controle, conservadorismo",
            },
            {
              name: "Cinco de Ouros",
              emoji: "‚ùÑÔ∏è",
              meaning: "Pen√∫ria, pobreza, preocupa√ß√£o material",
            },
            {
              name: "Seis de Ouros",
              emoji: "ü§ù",
              meaning: "Generosidade, caridade, aux√≠lio",
            },
            {
              name: "Sete de Ouros",
              emoji: "üå±",
              meaning: "Investimento, crescimento, espera",
            },
            {
              name: "Oito de Ouros",
              emoji: "üõ†Ô∏è",
              meaning: "Mestria, habilidade, dedica√ß√£o",
            },
            {
              name: "Nove de Ouros",
              emoji: "üí∞",
              meaning: "Independ√™ncia, abund√¢ncia, bem-estar",
            },
            {
              name: "Dez de Ouros",
              emoji: "üè∞",
              meaning: "Riqueza, heran√ßa, seguran√ßa familiar",
            },
            {
              name: "Pajem de Ouros",
              emoji: "üìö",
              meaning: "Estudo, aprendizado, potencial",
            },
            {
              name: "Cavaleiro de Ouros",
              emoji: "üêé",
              meaning: "Confiabilidade, produtividade, sensibilidade",
            },
            {
              name: "Rainha de Ouros",
              emoji: "üëë",
              meaning: "Practicidade, abund√¢ncia, feminilidade",
            },
            {
              name: "Rei de Ouros",
              emoji: "üíº",
              meaning: "Lideran√ßa, autoridade, riqueza",
            },
          ],
          espadas: [
            {
              name: "√Ås de Espadas",
              suit: "Espadas",
              emoji: "‚öîÔ∏è",
              meaning: "Nova verdade, clareza, poder da palavra",
            },
            {
              name: "Dois de Espadas",
              emoji: "üôà",
              meaning: "Indecis√£o, confus√£o, impasse",
            },
            {
              name: "Tr√™s de Espadas",
              emoji: "üíî",
              meaning: "Sofrimento, perda, dor emocional",
            },
            {
              name: "Quatro de Espadas",
              emoji: "üò¥",
              meaning: "Descanso, pausa, recupera√ß√£o",
            },
            {
              name: "Cinco de Espadas",
              emoji: "‚ö°",
              meaning: "Conflito, derrota, perda",
            },
            {
              name: "Seis de Espadas",
              emoji: "üö£",
              meaning: "Transi√ß√£o, viagem, movimento",
            },
            {
              name: "Sete de Espadas",
              emoji: "ü§•",
              meaning: "Engano, furtividade, desonestidade",
            },
            {
              name: "Oito de Espadas",
              emoji: "üîó",
              meaning: "Restri√ß√£o, aprisionamento, autoengano",
            },
            {
              name: "Nove de Espadas",
              emoji: "üò∞",
              meaning: "Ansiedade, pesadelo, preocupa√ß√£o",
            },
            {
              name: "Dez de Espadas",
              emoji: "‚ö∞Ô∏è",
              meaning: "Fim, finaliza√ß√£o, colapso",
            },
            {
              name: "Pajem de Espadas",
              emoji: "üë¶",
              meaning: "Intelig√™ncia, curiosidade, aud√°cia",
            },
            {
              name: "Cavaleiro de Espadas",
              emoji: "üó°Ô∏è",
              meaning: "A√ß√£o, verdade, justi√ßa",
            },
            {
              name: "Rainha de Espadas",
              emoji: "üïäÔ∏è",
              meaning: "Independ√™ncia, intelig√™ncia, clareza",
            },
            {
              name: "Rei de Espadas",
              emoji: "üë®‚Äç‚öñÔ∏è",
              meaning: "Intelig√™ncia, autoridade, verdade",
            },
          ],
          paus: [
            {
              name: "√Ås de Paus",
              suit: "Paus",
              emoji: "üî•",
              meaning: "Criatividade, novo potencial, energia",
            },
            {
              name: "Dois de Paus",
              emoji: "ü§ù",
              meaning: "Parcerias, planeamento, vis√£o",
            },
            {
              name: "Tr√™s de Paus",
              emoji: "üåç",
              meaning: "Expans√£o, explora√ß√£o, oportunidade",
            },
            {
              name: "Quatro de Paus",
              emoji: "üéä",
              meaning: "Celebra√ß√£o, comunidade, harmonia",
            },
            {
              name: "Cinco de Paus",
              emoji: "‚ö°",
              meaning: "Conflito, competi√ß√£o, tension",
            },
            {
              name: "Seis de Paus",
              emoji: "üèÖ",
              meaning: "Vit√≥ria, reconhecimento, √™xito",
            },
            {
              name: "Sete de Paus",
              emoji: "üõ°Ô∏è",
              meaning: "Defesa, prote√ß√£o, persist√™ncia",
            },
            {
              name: "Oito de Paus",
              emoji: "üí®",
              meaning: "Movimento r√°pido, progresso, comunica√ß√£o",
            },
            {
              name: "Nove de Paus",
              emoji: "‚õ∞Ô∏è",
              meaning: "Resist√™ncia, for√ßa, vigil√¢ncia",
            },
            {
              name: "Dez de Paus",
              emoji: "ü™µ",
              meaning: "Carga, responsabilidade, fam√≠lia",
            },
            {
              name: "Pajem de Paus",
              emoji: "üßó",
              meaning: "Aventura, explora√ß√£o, entusiasmo",
            },
            {
              name: "Cavaleiro de Paus",
              emoji: "üê¥",
              meaning: "Energia, paix√£o, a√ß√£o r√°pida",
            },
            {
              name: "Rainha de Paus",
              emoji: "üîÆ",
              meaning: "Intui√ß√£o criativa, confian√ßa, independ√™ncia",
            },
            {
              name: "Rei de Paus",
              emoji: "üî±",
              meaning: "Lideran√ßa criativa, carisma, inspira√ß√£o",
            },
          ],
        },
      };

      // Helper: resolve card image from deck folder (/backend/art/<index>.webp)
      function getCardImageFor(card) {
        const majorIndex = tarotCards.majorArcana.indexOf(card);
        if (majorIndex !== -1) return `/backend/art/${majorIndex}.webp`;

        const suitBases = { copas: 22, espadas: 36, paus: 50, ouros: 64 };
        for (const [suitKey, base] of Object.entries(suitBases)) {
          const arr = tarotCards.minorArcana[suitKey];
          if (!arr) continue;
          const idx = arr.indexOf(card);
          if (idx !== -1) return `/backend/art/${base + idx}.webp`;
        }

        return "/backend/art/78.webp";
      }

      // Shuffle helper and unique draw
      function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
      }

      function drawUniqueCards(count, source = "all") {
        let cardPool = [];
        if (source === "all" || source === "major")
          cardPool.push(...tarotCards.majorArcana);
        if (source === "all" || source === "minor")
          Object.values(tarotCards.minorArcana).forEach((s) =>
            cardPool.push(...s)
          );
        const pool = [...cardPool];
        shuffleArray(pool);
        return pool.slice(0, Math.min(count, pool.length));
      }

      let currentReadingType = "daily";
      let drawnCards = { daily: null, three: [], celtic: [] };

      // ===== READING TYPE SELECTOR =====
      function setReadingType(type) {
        currentReadingType = type;
        document
          .querySelectorAll(".reading-type-btn")
          .forEach((btn) => btn.classList.remove("active"));
        if (arguments.length > 1 && arguments[1]) {
          arguments[1].classList.add("active");
        } else {
          const fallbackBtn = document.querySelector(
            `.reading-type-btn[onclick^="setReadingType('${type}'"]`
          );
          fallbackBtn?.classList.add("active");
        }

        document.querySelectorAll(".reading-container").forEach((container) => {
          container.style.display = "none";
        });
        document.getElementById(type + "-reading").style.display = "block";

        // Clear previous results
        document.getElementById(type + "-result").style.display = "none";
      }

      // ===== GET RANDOM CARD =====
      function getRandomCard(source = "all") {
        let cardPool = [];

        if (source === "all" || source === "major") {
          cardPool.push(...tarotCards.majorArcana);
        }
        if (source === "all" || source === "minor") {
          Object.values(tarotCards.minorArcana).forEach((suit) => {
            cardPool.push(...suit);
          });
        }

        return cardPool[Math.floor(Math.random() * cardPool.length)];
      }

      // ===== FORMAT CARD DISPLAY =====
      function formatCardDisplay(card, isReversed = false) {
        const reversed = isReversed ? " (Invertida)" : "";
        const reversedClass = isReversed ? "card-reversed" : "";

        if (card.number) {
          // Major Arcana
          return `
            <div class="card-info">
              <div class="card-emoji"><img src="${getCardImageFor(
                card
              )}" alt="${
            card.name
          }" class="card-image-preview" onerror="this.src='/backend/art/78.webp'"></div>
              <div class="card-name">${card.name}${reversed}</div>
              <div class="card-suit">Arcano Maior ‚Ä¢ ${card.number}</div>
              <div class="card-element">Elemento: ${card.element}</div>
            </div>
            <div class="card-meaning">
              <div class="card-meaning-label">${
                isReversed
                  ? "üîÑ Significado Invertido"
                  : "‚úì Significado Direito"
              }</div>
              <div class="card-meaning-text">${
                isReversed ? card.reversed : card.upright
              }</div>
            </div>
            <div class="card-meaning ${reversedClass}">
              <div class="card-meaning-label">üí° Interpreta√ß√£o</div>
              <div class="card-meaning-text">${card.meaning}</div>
            </div>
          `;
        } else {
          // Minor Arcana
          const suit = card.suit || "Arcano Menor";
          return `
            <div class="card-info">
              <div class="card-emoji"><img src="${getCardImageFor(
                card
              )}" alt="${
            card.name
          }" class="card-image-preview" onerror="this.src='/backend/art/78.webp'"></div>
              <div class="card-name">${card.name}${reversed}</div>
              <div class="card-suit">${suit}</div>
            </div>
            <div class="card-meaning">
              <div class="card-meaning-label">${
                isReversed ? "üîÑ Significado Invertido" : "‚úì Significado"
              }</div>
              <div class="card-meaning-text">${card.meaning}</div>
            </div>
          `;
        }
      }

      // ===== DAILY CARD DRAW =====
      function drawCard(type) {
        const resultDiv = document.getElementById("daily-result");
        resultDiv.innerHTML =
          '<div style="text-align: center; padding: 2rem;"><p>‚ú® A tirando uma carta...</p></div>';
        resultDiv.style.display = "block";

        // Simulate draw delay for better UX
        setTimeout(() => {
          const card = getRandomCard("all");
          const isReversed = Math.random() > 0.5;
          drawnCards.daily = { card, isReversed };

          resultDiv.innerHTML = formatCardDisplay(card, isReversed);
          
          // Track this reading
          trackReading();
        }, 600);
      }

      // ===== THREE CARD SPREAD =====
      function drawThreeCards() {
        const resultDiv = document.getElementById("three-result");
        resultDiv.innerHTML =
          '<div style="text-align: center; padding: 2rem;"><p>‚ú® Tirando 3 cartas...</p></div>';
        resultDiv.style.display = "block";

        setTimeout(() => {
          drawnCards.three = [];
          const positions = ["Passado", "Presente", "Futuro"];

          // Draw 3 unique cards
          const cards = drawUniqueCards(3, "all");
          for (let i = 0; i < cards.length; i++) {
            const card = cards[i];
            const isReversed = Math.random() > 0.5;
            drawnCards.three.push({ card, isReversed, position: positions[i] });
          }

          let html =
            '<h3 style="text-align: center; margin-bottom: 2rem; color: var(--color-dark-purple);">Tirada de 3 Cartas</h3>';
          html += '<div class="three-cards-grid">';

          drawnCards.three.forEach((item, index) => {
            html += `
              <div class="three-card-item">
                <div class="three-card-position">üìç ${item.position}</div>
                <div style="text-align: center;">
                  <div style="margin: 0.5rem 0;">
                    <img src="${getCardImageFor(item.card)}" alt="${
              item.card.name
            }" style="width:64px;height:auto;border-radius:6px;box-shadow:0 6px 18px rgba(0,0,0,0.08);" onerror="this.src='/backend/art/78.webp'">
                  </div>
                  <div style="font-weight: 600; color: var(--color-dark-purple); margin: 0.5rem 0;">
                    ${item.card.name}${item.isReversed ? " (Invertida)" : ""}
                  </div>
                  <div style="font-size: 0.85rem; color: var(--color-text-light); margin-top: 0.5rem;">
                    ${item.card.meaning || item.card.upright}
                  </div>
                </div>
              </div>
            `;
          });

          html += "</div>";
          html +=
            '<button class="cta-button" style="margin-top: 2rem;" onclick="saveReading(\'three\')">üíæ Guardar Esta Leitura</button>';
          resultDiv.innerHTML = html;
          saveReadingToHistory("three", drawnCards.three);
        }, 800);
      }

      // ===== CHAKRA SPREAD =====
      const chakras = [
        {
          name: "Muladhara",
          emoji: "üî¥",
          element: "Terra",
          meaning: "Raiz - Seguran√ßa e Estabilidade",
        },
        {
          name: "Swadhisthana",
          emoji: "üü†",
          element: "√Ågua",
          meaning: "Sagrado - Criatividade e Prazer",
        },
        {
          name: "Manipura",
          emoji: "üü°",
          element: "Fogo",
          meaning: "Plexo Solar - Poder e Vontade",
        },
        {
          name: "Anahata",
          emoji: "üíö",
          element: "Ar",
          meaning: "Cora√ß√£o - Amor e Compaix√£o",
        },
        {
          name: "Vishuddha",
          emoji: "üîµ",
          element: "√âter",
          meaning: "Garganta - Express√£o e Verdade",
        },
        {
          name: "Ajna",
          emoji: "üü£",
          element: "Luz",
          meaning: "Terceiro Olho - Intui√ß√£o e Sabedoria",
        },
        {
          name: "Sahasrara",
          emoji: "üëë",
          element: "Espiritualidade",
          meaning: "Coroa - Ilumina√ß√£o e Conex√£o",
        },
      ];
      function drawChakraSpread() {
        const resultDiv = document.getElementById("chakra-result");
        resultDiv.innerHTML =
          '<div style="text-align: center; padding: 2rem;"><p>? Alinhando os teus chakras...</p></div>';
        resultDiv.style.display = "block";
        setTimeout(() => {
          drawnCards.chakra = [];
          let html =
            '<h3 style="text-align: center; margin-bottom: 2rem; color: var(--color-dark-purple);">Leitura de Chakras - 7 Energias</h3>';
          html += '<div class="chakra-cards-grid">';
          // Draw 7 unique cards for chakras
          const chakraCards = drawUniqueCards(chakras.length, "all");
          chakraCards.forEach((card, index) => {
            const isReversed = Math.random() > 0.5;
            drawnCards.chakra.push({
              card,
              chakra: chakras[index].name,
              isReversed,
            });
            const meaning = isReversed
              ? card.reversedMeaning || card.meaning
              : card.meaning;
            const direction = isReversed ? "(Invertida)" : "(Direita)";
            html += `
              <div class="chakra-card-item">
                <div class="chakra-name">${chakras[index].emoji} ${
              chakras[index].name
            }</div>
                <div class="chakra-card-name" role="heading" aria-level="4">${
                  card.name
                } ${direction}</div>
                <div class="chakra-emoji"><img src="${getCardImageFor(
                  card
                )}" alt="${
              card.name
            }" style="width:48px;height:auto;border-radius:6px;" onerror="this.src='/backend/art/78.webp'"></div>
                <div class="chakra-card-meaning">${meaning}</div>
                <div style="font-size: 0.7rem; color: var(--color-text-light); margin-top: 0.5rem; border-top: 1px solid rgba(212, 165, 116, 0.3); padding-top: 0.5rem;">${
                  chakras[index].element
                }</div>
              </div>
            `;
          });
          html += "</div>";
          html +=
            '<button class="cta-button" style="margin-top: 2rem;" onclick="saveReadingToHistory(\'Chakra\')">Guardar Leitura</button>';
          resultDiv.innerHTML = html;
          resultDiv.scrollIntoView({ behavior: "smooth", block: "nearest" });
        }, 1000);
      }
      // ===== MOON PHASE CALCULATION =====
      function calculateMoonPhase() {
        try {
          // Precise Julian Date calculation (UTC-aware)
          const now = new Date();
          const yyyy = now.getUTCFullYear();
          let mm = now.getUTCMonth() + 1; // 1-12
          const dd =
            now.getUTCDate() +
            now.getUTCHours() / 24 +
            now.getUTCMinutes() / 1440 +
            now.getUTCSeconds() / 86400;

          let y = yyyy;
          if (mm <= 2) {
            y -= 1;
            mm += 12;
          }

          const A = Math.floor(y / 100);
          const B = 2 - A + Math.floor(A / 4);
          const jd =
            Math.floor(365.25 * (y + 4716)) +
            Math.floor(30.6001 * (mm + 1)) +
            dd +
            B -
            1524.5;

          // Age in days since known new moon epoch
          const d = jd - 2451550.1;
          // Normalize fraction of lunation [0,1)
          const lunation = d / 29.53058867;
          const x = lunation - Math.floor(lunation);

          const phases = [
            { name: "üåë Lua Nova", range: [0, 0.125] },
            { name: "üåí Lua Crescente", range: [0.125, 0.25] },
            { name: "üåì Quarto Crescente", range: [0.25, 0.375] },
            { name: "üåî Lua Crescente (Iluminada)", range: [0.375, 0.5] },
            { name: "üåï Lua Cheia", range: [0.5, 0.625] },
            { name: "üåñ Lua Minguante", range: [0.625, 0.75] },
            { name: "üåó Quarto Minguante", range: [0.75, 0.875] },
            { name: "üåò Lua Minguante (Escura)", range: [0.875, 1] },
          ];

          for (let phase of phases) {
            if (x >= phase.range[0] && x < phase.range[1]) {
              return phase.name;
            }
          }
          return "üåë Lua Nova";
        } catch (err) {
          console.error("calculateMoonPhase error:", err);
          return "‚Äî";
        }
      }

      // Safely update moon phase and date on load; keep independent updates
      window.addEventListener("load", () => {
        const moonPhaseEl = document.getElementById("moon-phase-display");
        const moonDateEl = document.getElementById("moon-date");
        try {
          if (moonPhaseEl) {
            const moonPhase = calculateMoonPhase();
            moonPhaseEl.textContent = moonPhase;
          }
          if (moonDateEl) {
            const today = new Date().toLocaleDateString("pt-PT", {
              weekday: "long",
              year: "numeric",
              month: "long",
              day: "numeric",
            });
            moonDateEl.textContent = today;
          }
        } catch (err) {
          console.error("Error updating moon phase/date:", err);
          if (moonPhaseEl) moonPhaseEl.textContent = "Erro a carregar";
        }
      });
      // ===== CELTIC CROSS SPREAD =====
      function drawCelticCross() {
        const resultDiv = document.getElementById("celtic-result");
        resultDiv.innerHTML =
          '<div style="text-align: center; padding: 2rem;"><p>‚ú® Constructing Cruz Celta...</p></div>';
        resultDiv.style.display = "block";

        setTimeout(() => {
          drawnCards.celtic = [];
          const positions = [
            { num: "1", name: "Significa√ß√£o", meaning: "O n√∫cleo da quest√£o" },
            { num: "2", name: "Obst√°culos", meaning: "O que vai contra" },
            { num: "3", name: "Coroa", meaning: "Aspira√ß√µes ocultas" },
            { num: "4", name: "Raiz", meaning: "Influ√™ncia oculta" },
            { num: "5", name: "Passado Pr√≥ximo", meaning: "Contexto recente" },
            {
              num: "6",
              name: "Futuro Pr√≥ximo",
              meaning: "Desenvolvimento esperado",
            },
            { num: "7", name: "Atitude", meaning: "Sua posi√ß√£o" },
            { num: "8", name: "Ambiente", meaning: "Influ√™ncias externas" },
            {
              num: "9",
              name: "Esperan√ßa/Medo",
              meaning: "O que espera ou teme",
            },
            { num: "10", name: "Resultado", meaning: "Desfecho prov√°vel" },
          ];

          // Draw 10 unique cards for the Celtic Cross
          const celticCards = drawUniqueCards(10, "all");
          for (let i = 0; i < celticCards.length; i++) {
            const card = celticCards[i];
            const isReversed = Math.random() > 0.5;
            drawnCards.celtic.push({
              card,
              isReversed,
              position: positions[i],
            });
          }

          let html =
            '<h3 style="text-align: center; margin-bottom: 2rem; color: var(--color-dark-purple);">Cruz Celta (10 Posi√ß√µes)</h3>';
          html += '<div class="celtic-grid">';

          drawnCards.celtic.forEach((item) => {
            html += `
              <div class="celtic-position">
                <div class="celtic-position-number">Posi√ß√£o ${
                  item.position.num
                }</div>
                <div class="celtic-position-name">${item.position.name}</div>
                <div class="celtic-position-emoji"><img src="${getCardImageFor(
                  item.card
                )}" alt="${
              item.card.name
            }" style="width:48px;height:auto;border-radius:6px;" onerror="this.src='/backend/art/78.webp'"></div>
                <div class="celtic-position-card">
                  ${item.card.name}<br><small>${
              item.isReversed ? "(Invertida)" : ""
            }</small>
                </div>
                <div style="font-size: 0.8rem; color: var(--color-text-light); margin-top: 0.5rem;">
                  <em>${item.position.meaning}</em>
                </div>
              </div>
            `;
          });

          html += "</div>";
          html +=
            '<button class="cta-button" style="margin-top: 2rem;" onclick="saveReading(\'celtic\')">üíæ Guardar Esta Leitura</button>';
          resultDiv.innerHTML = html;
          saveReadingToHistory("celtic", drawnCards.celtic);
        }, 1000);
      }

      // ===== EXISTING FUNCTIONS =====
      function smoothScrollTo(id) {
        const element = document.querySelector(id);
        if (element) {
          element.scrollIntoView({ behavior: "smooth" });
        }
      }

      function toggleFaq(element) {
        const answer = element.nextElementSibling;
        const icon = element.querySelector(".faq-icon");

        document.querySelectorAll(".faq-answer").forEach((el) => {
          if (el !== answer) el.classList.remove("active");
        });
        document.querySelectorAll(".faq-icon").forEach((el) => {
          if (el !== icon) el.classList.remove("active");
        });

        answer.classList.toggle("active");
        icon.classList.toggle("active");
      }

      // ===== READING HISTORY =====
      function saveReadingToHistory(type, cards) {
        const history = JSON.parse(
          localStorage.getItem("tarotHistory") || "[]"
        );
        const reading = {
          id: Date.now(),
          type: type,
          date: new Date().toLocaleString("pt-PT"),
          cards: cards,
        };

        history.unshift(reading);
        if (history.length > 20) history.pop(); // Keep only last 20 readings
        localStorage.setItem("tarotHistory", JSON.stringify(history));
      }

      function saveReading(type) {
        const cards = drawnCards[type];
        if (cards) {
          saveReadingToHistory(type, cards);
          alert(
            "‚úì Leitura guardada com sucesso! Pode consult√°-la a qualquer momento."
          );
        }
      }

      function viewReadingHistory() {
        const history = JSON.parse(
          localStorage.getItem("tarotHistory") || "[]"
        );
        if (history.length === 0) {
          alert("Nenhuma leitura guardada ainda. Tire uma carta para come√ßar!");
          return;
        }

        let html = "<h3>üìñ Hist√≥rico de Leituras</h3>";
        history.forEach((reading, index) => {
          html += `<div style="padding: 1rem; border: 1px solid #ccc; margin: 0.5rem 0; border-radius: 8px;">
            <strong>${index + 1}. ${reading.type.toUpperCase()}</strong> - ${
            reading.date
          }
            <button onclick="deleteReading(${
              reading.id
            })" style="float: right; background: #ff6b6b; color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer;">Eliminar</button>
          </div>`;
        });

        const modal = document.createElement("div");
        modal.innerHTML = `
          <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 2000;">
            <div style="background: white; padding: 2rem; border-radius: 12px; max-width: 500px; max-height: 600px; overflow-y: auto;">
              ${html}
              <button onclick="this.parentElement.parentElement.remove()" style="width: 100%; padding: 0.75rem; margin-top: 1rem; background: #4b0082; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">Fechar</button>
            </div>
          </div>
        `;
        document.body.appendChild(modal);
      }

      function deleteReading(id) {
        const history = JSON.parse(
          localStorage.getItem("tarotHistory") || "[]"
        );
        const filtered = history.filter((r) => r.id !== id);
        localStorage.setItem("tarotHistory", JSON.stringify(filtered));
        viewReadingHistory();
      }

      // Add history button to page on load
      window.addEventListener("load", () => {
        const historyBtn = document.createElement("button");
        historyBtn.className = "cta-button";
        historyBtn.innerHTML = "üìñ Hist√≥rico";
        historyBtn.onclick = viewReadingHistory;
        historyBtn.style.position = "fixed";
        historyBtn.style.bottom = "90px"; // Positioned above the Formspree widget
        historyBtn.style.right = "20px";
        historyBtn.style.zIndex = "998";
        historyBtn.style.fontSize = "0.9rem";
        historyBtn.style.padding = "0.75rem 1.25rem";
        document.body.appendChild(historyBtn);
      });

      // ===== EMAIL FORM HANDLER =====
      async function handleContactForm(event) {
        event.preventDefault();
        const form = event.target;
        const formData = new FormData(form);

        const name = formData.get("name");
        const email = formData.get("email");
        const message = formData.get("message");

        // Validate form
        if (!name || !email || !message) {
          alert("‚ùå Por favor, preencha todos os campos!");
          return;
        }

        if (!email.includes("@")) {
          alert("‚ùå Email inv√°lido!");
          return;
        }

        // Send via FormSubmit (free service - no backend needed)
        try {
          const response = await fetch("https://formspree.io/f/xqeekpde", {
            method: "POST",
            body: formData,
            headers: { Accept: "application/json" },
          });

          if (response.ok) {
            alert("‚úÖ Mensagem enviada com sucesso! Responderemos em breve.");
            form.reset();
          } else {
            // Fallback to mailto
            const mailtoLink = `mailto:contacto@rafaellakally.com?subject=Contacto de ${name}&body=${encodeURIComponent(
              message
            )}\n\nDe: ${name}\nEmail: ${email}`;
            window.location.href = mailtoLink;
            alert("‚úÖ Abrindo seu cliente de email...");
          }
        } catch (error) {
          // Fallback to mailto if fetch fails
          const mailtoLink = `mailto:contacto@rafaellakally.com?subject=Contacto de ${name}&body=${encodeURIComponent(
            message
          )}\n\nDe: ${name}\nEmail: ${email}`;
          window.location.href = mailtoLink;
        }
      }

      // Enrollment form handler
      async function handleEnrollment(event) {
        event.preventDefault();
        const form = event.target;
        const formData = new FormData(form);

        const name = formData.get("name");
        const email = formData.get("email");
        const phone = formData.get("phone");
        const course = formData.get("course");

        if (!name || !email) {
          alert("‚ùå Nome e email s√£o obrigat√≥rios!");
          return;
        }

        // Create enrollment email
        const message = `
Inscri√ß√£o de Novo Aluno
========================

Nome: ${name}
Email: ${email}
Telefone: ${phone || "N√£o fornecido"}
Curso/M√≥dulo: ${course}

Acesse o painel de alunos para processar esta inscri√ß√£o.
        `;

        try {
          const enrollmentForm = new FormData();
          enrollmentForm.append("name", name);
          enrollmentForm.append("email", email);
          enrollmentForm.append("phone", phone);
          enrollmentForm.append("course", course);

          const response = await fetch("https://formspree.io/f/xqeekpde", {
            method: "POST",
            body: enrollmentForm,
            headers: { Accept: "application/json" },
          });

          if (response.ok) {
            alert(
              "‚úÖ Inscri√ß√£o enviada! Voc√™ receber√° um email de confirma√ß√£o em breve."
            );
            form.reset();
          } else {
            const mailtoLink = `mailto:contacto@rafaellakally.com?subject=Inscri√ß√£o - ${course}&body=${encodeURIComponent(
              message
            )}`;
            window.location.href = mailtoLink;
            alert("‚úÖ Abrindo seu cliente de email...");
          }
        } catch (error) {
          const mailtoLink = `mailto:contacto@rafaellakally.com?subject=Inscri√ß√£o - ${course}&body=${encodeURIComponent(
            message
          )}`;
          window.location.href = mailtoLink;
        }
      }
    </script>
    <!-- Formspree Floating Widget -->
    <div id="fs-widget" aria-hidden="true">
      <button
        id="fs-open"
        class="fs-fab"
        aria-label="Abrir formul√°rio de contacto"
        title="D√∫vidas? Fale comigo!"
      >
        <span class="fs-fab-text">D√∫vidas? Fale comigo!</span>
        <span class="fs-fab-icon" aria-hidden="true">üí¨</span>
      </button>
      <aside
        id="fs-panel"
        class="fs-panel"
        role="dialog"
        aria-modal="true"
        aria-labelledby="fs-title"
        aria-hidden="true"
      >
        <header class="fs-header">
          <h3 id="fs-title">Contacto R√°pido</h3>
          <button
            id="fs-close"
            class="fs-close"
            aria-label="Fechar formul√°rio"
            title="Fechar formul√°rio"
          >
            √ó
          </button>
        </header>
        <form
          id="fs-form"
          class="fs-form"
          action="https://formspree.io/f/xqeekpde"
          method="POST"
        >
          <input
            type="hidden"
            name="_subject"
            value="Site Popup: Contacto R√°pido"
          />
          <label for="fs-name">Nome</label>
          <input id="fs-name" name="name" type="text" required />
          <label for="fs-email">Email</label>
          <input id="fs-email" name="email" type="email" required />
          <label for="fs-message">Mensagem</label>
          <textarea id="fs-message" name="message" rows="4" required></textarea>
          <div class="fs-actions">
            <button type="submit" class="btn">Enviar</button>
            <button type="button" id="fs-cancel" class="btn ghost">
              Cancelar
            </button>
          </div>
        </form>
        <div
          id="fs-status"
          class="fs-status"
          role="status"
          aria-live="polite"
        ></div>
      </aside>
    </div>

    <style>
      /* Floating Formspree widget styles */
      #fs-widget {
        position: fixed;
        z-index: 9999;
        right: 20px;
        bottom: 20px;
        font-family: inherit;
      }
      .fs-fab {
        /* Pill layout: allows short text while keeping a compact shape */
        display: inline-flex;
        align-items: center;
        justify-content: center;
        min-width: 56px;
        height: 56px;
        padding: 0 14px;
        border-radius: 28px;
        border: none;
        cursor: pointer;
        font-size: 14px;
        line-height: 1;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        box-shadow: 0 6px 22px rgba(0, 0, 0, 0.28);
        background: linear-gradient(135deg, #5b0f7a, #7a1aa1);
        color: #ffffff;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      .fs-fab .fs-fab-icon {
        display: none;
        margin-left: 8px;
      }
      .fs-fab .fs-fab-text {
        display: inline-block;
      }
      /* Small screens: switch back to a circular FAB showing only an icon */
      @media (max-width: 480px) {
        .fs-fab {
          min-width: 56px;
          width: 56px;
          padding: 0;
          border-radius: 999px;
          font-size: 20px;
        }
        .fs-fab .fs-fab-text {
          display: none;
        }
        .fs-fab .fs-fab-icon {
          display: inline-block;
        }
      }
      .fs-panel {
        width: 340px;
        max-width: calc(100vw - 40px);
        background: var(--bg, #fff);
        color: var(--text, #222);
        box-shadow: 0 12px 36px rgba(0, 0, 0, 0.25);
        border-radius: 10px;
        padding: 12px;
        margin-bottom: 14px;
        transform: translateY(12px) scale(0.98);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.2s ease, transform 0.2s ease;
      }
      #fs-widget.open .fs-panel {
        opacity: 1;
        transform: translateY(0) scale(1);
        pointer-events: auto;
      }
      .fs-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
        margin-bottom: 8px;
        padding-bottom: 6px;
        border-bottom: 1px solid rgba(0, 0, 0, 0.06);
      }
      .fs-header h3 {
        margin: 0;
        font-size: 1rem;
      }
      .fs-close {
        background: transparent;
        border: none;
        font-size: 18px;
        cursor: pointer;
        color: var(--color-dark-purple);
        width: 36px;
        height: 36px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border-radius: 6px;
      }
      .fs-close:hover {
        background: rgba(75, 0, 130, 0.06);
      }
      .fs-form label {
        display: block;
        margin: 6px 0 4px;
        font-size: 0.9rem;
      }
      .fs-form input,
      .fs-form textarea {
        width: 100%;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 0.95rem;
      }
      .fs-actions {
        display: flex;
        gap: 8px;
        margin-top: 10px;
      }
      .fs-actions .btn {
        flex: 1;
        min-width: 0;
      }
      .fs-actions .btn.ghost {
        background: transparent;
        border: 1px solid #ddd;
        color: var(--color-text);
      }
      .fs-status {
        margin-top: 8px;
        font-size: 0.9rem;
        min-height: 20px;
      }
      @media (max-width: 520px) {
        .fs-panel {
          right: 10px;
          left: 10px;
          bottom: 80px;
          width: auto;
        }
        #fs-widget {
          right: 10px;
          bottom: 18px;
        }
      }
    </style>

    <script>
      (function () {
        const widget = document.getElementById("fs-widget");
        const openBtn = document.getElementById("fs-open");
        const closeBtn = document.getElementById("fs-close");
        const cancelBtn = document.getElementById("fs-cancel");
        const panel = document.getElementById("fs-panel");
        const form = document.getElementById("fs-form");
        const status = document.getElementById("fs-status");

        if (!widget || !openBtn || !panel || !form) return;

        function openWidget() {
          widget.classList.add("open");
          panel.setAttribute("aria-hidden", "false");
          document.body.classList.add("fs-open");
          const first = form.querySelector("input, textarea");
          if (first) first.focus();
        }
        function closeWidget() {
          widget.classList.remove("open");
          panel.setAttribute("aria-hidden", "true");
          document.body.classList.remove("fs-open");
          openBtn.focus();
        }

        openBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          openWidget();
        });
        closeBtn.addEventListener("click", closeWidget);
        cancelBtn.addEventListener("click", closeWidget);

        document.addEventListener("click", (e) => {
          if (!widget.classList.contains("open")) return;
          if (!panel.contains(e.target) && e.target !== openBtn) closeWidget();
        });

        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape" && widget.classList.contains("open"))
            closeWidget();
        });

        form.addEventListener("submit", async (e) => {
          e.preventDefault();
          status.textContent = "Enviando...";
          const fd = new FormData(form);
          try {
            const res = await fetch(form.action, {
              method: "POST",
              body: fd,
              headers: { Accept: "application/json" },
            });
            console.log("Formspree response status:", res.status);
            let data = null;
            try {
              data = await res.json();
              console.log("Formspree response JSON:", data);
            } catch (e) {
              console.log("No JSON response or failed to parse");
            }
            if (res.ok) {
              status.textContent = "‚úÖ Enviado com sucesso. Obrigado!";
              form.reset();
              setTimeout(closeWidget, 1200);
            } else if (res.status === 404) {
              status.textContent =
                "Formul√°rio n√£o encontrado (404). Verifique o Formspree ID.";
              console.error("Formspree 404 - confirm endpoint:", form.action);
            } else {
              status.textContent =
                data && data.errors
                  ? data.errors.map((x) => x.message).join(", ")
                  : `Erro ao enviar (status ${res.status}).`;
            }
          } catch (err) {
            console.error("Formspree submit error:", err);
            status.textContent = "Erro de rede. Tente novamente.";
          }
        });
      })();
    </script>
  </body>
</html>
